<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japanese Counter Quiz - „Åò„Çá„Åô„ÅÜ„Åó „Çå„Çì„Åó„ÇÖ„ÅÜ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Zen+Maru+Gothic:wght@400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans JP', 'Zen Maru Gothic', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: clamp(10px, 3vw, 20px);
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            text-align: center;
            color: white;
            margin-bottom: clamp(15px, 3vw, 30px);
            padding: clamp(15px, 3vw, 25px);
            background: rgba(255,255,255,0.1);
            border-radius: clamp(15px, 2vw, 20px);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: clamp(24px, 5vw, 40px);
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: clamp(14px, 2.5vw, 18px);
            opacity: 0.9;
        }
        
        /* Score Board */
        .score-board {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: clamp(12px, 2vw, 20px);
            padding: clamp(15px, 3vw, 25px);
            margin-bottom: clamp(15px, 2vw, 20px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .score-item {
            text-align: center;
            min-width: 80px;
        }
        
        .score-label {
            font-size: clamp(11px, 1.8vw, 14px);
            color: #666;
            margin-bottom: 5px;
        }
        
        .score-value {
            font-size: clamp(22px, 4vw, 32px);
            font-weight: bold;
            color: #0f3460;
        }
        
        .progress-container {
            width: clamp(120px, 20vw, 200px);
        }
        
        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e94560, #ff6b6b);
            border-radius: 6px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        /* Section Tabs */
        .section-tabs {
            display: flex;
            gap: clamp(8px, 1.5vw, 12px);
            margin-bottom: clamp(15px, 2vw, 20px);
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tab-btn {
            padding: clamp(10px, 2vw, 14px) clamp(16px, 3vw, 28px);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: clamp(13px, 2vw, 16px);
            font-weight: 600;
            transition: all 0.3s;
            background: rgba(255,255,255,0.2);
            color: white;
            position: relative;
        }
        
        .tab-btn:hover:not(.completed):not(.locked) {
            background: rgba(255,255,255,0.4);
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            background: white;
            color: #0f3460;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .tab-btn.completed {
            background: #4caf50;
            color: white;
            cursor: default;
        }
        
        .tab-btn.completed::after {
            content: ' ‚úì';
        }
        
        .tab-btn.locked {
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.4);
            cursor: not-allowed;
        }
        
        /* Reference Toggle */
        .reference-toggle {
            text-align: center;
            margin-bottom: clamp(12px, 2vw, 20px);
        }
        
        .reference-btn {
            padding: clamp(10px, 2vw, 12px) clamp(20px, 4vw, 30px);
            background: rgba(255,255,255,0.15);
            color: white;
            border: 2px solid rgba(255,255,255,0.5);
            border-radius: 25px;
            font-size: clamp(13px, 2vw, 15px);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .reference-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }
        
        /* Reference Card */
        .reference-card {
            display: none;
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: clamp(12px, 2vw, 20px);
            padding: clamp(15px, 3vw, 25px);
            margin-bottom: clamp(15px, 2vw, 20px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .reference-card.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .ref-title {
            font-size: clamp(18px, 3vw, 24px);
            color: #0f3460;
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #e94560;
        }
        
        .ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .ref-box {
            padding: clamp(12px, 2vw, 18px);
            border-radius: 12px;
            background: #f8f9ff;
            border-left: 4px solid;
        }
        
        .ref-box.time { border-color: #e94560; background: linear-gradient(135deg, #ffe0e6 0%, #fff 100%); }
        .ref-box.things { border-color: #48dbfb; background: linear-gradient(135deg, #e0f7ff 0%, #fff 100%); }
        .ref-box.people { border-color: #ff9f43; background: linear-gradient(135deg, #fff3e0 0%, #fff 100%); }
        .ref-box.objects { border-color: #26de81; background: linear-gradient(135deg, #e0ffe6 0%, #fff 100%); }
        .ref-box.animals { border-color: #a55eea; background: linear-gradient(135deg, #f3e5f5 0%, #fff 100%); }
        
        .ref-box-title {
            font-size: clamp(14px, 2vw, 16px);
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ref-box-content {
            font-size: clamp(12px, 1.8vw, 14px);
            color: #555;
            line-height: 1.8;
        }
        
        .counter-tag {
            display: inline-block;
            padding: 2px 8px;
            background: rgba(0,0,0,0.1);
            border-radius: 4px;
            margin: 2px;
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        /* Quiz Section */
        .quiz-section {
            display: none;
        }
        
        .quiz-section.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Card */
        .card {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: clamp(15px, 2.5vw, 25px);
            padding: clamp(20px, 4vw, 35px);
            margin-bottom: clamp(15px, 2vw, 20px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #e94560, #ff6b6b, #feca57, #48dbfb);
        }
        
        .card-title {
            font-size: clamp(18px, 3vw, 24px);
            color: #0f3460;
            margin-bottom: clamp(15px, 2.5vw, 25px);
            padding-bottom: 12px;
            border-bottom: 2px solid #e94560;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Question Box */
        .question-box {
            background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
            border-radius: clamp(12px, 2vw, 18px);
            padding: clamp(18px, 3vw, 30px);
            margin-bottom: 15px;
            border: 2px solid #e0e5f0;
        }
        
        .question-number {
            font-size: clamp(12px, 1.8vw, 14px);
            color: #e94560;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .question-context {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: clamp(10px, 2vw, 20px);
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .counter-emoji {
            font-size: clamp(40px, 8vw, 60px);
        }
        
        .question-text {
            font-size: clamp(15px, 2.5vw, 20px);
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .japanese-prompt {
            font-size: clamp(28px, 6vw, 44px);
            color: #0f3460;
            font-weight: bold;
            text-align: center;
            margin: clamp(15px, 3vw, 25px) 0;
        }
        
        .number-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }
        
        .number-badge {
            font-size: clamp(32px, 6vw, 48px);
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #e94560, #ff6b6b);
            width: clamp(60px, 12vw, 80px);
            height: clamp(60px, 12vw, 80px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(233, 69, 96, 0.4);
        }
        
        .counter-indicator {
            display: inline-block;
            padding: clamp(6px, 1.5vw, 10px) clamp(12px, 2.5vw, 20px);
            border-radius: 20px;
            font-size: clamp(13px, 2vw, 16px);
            font-weight: bold;
            margin: 5px;
        }
        
        .counter-indicator.time { background: #ffe0e6; color: #c62828; }
        .counter-indicator.things { background: #e0f7ff; color: #0277bd; }
        .counter-indicator.people { background: #fff3e0; color: #e65100; }
        .counter-indicator.objects { background: #e0ffe6; color: #2e7d32; }
        .counter-indicator.animals { background: #f3e5f5; color: #6a1b9a; }
        
        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: clamp(10px, 2vw, 15px);
            margin-top: 20px;
        }
        
        @media (max-width: 500px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .option-btn {
            padding: clamp(14px, 3vw, 20px);
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            font-size: clamp(18px, 3.5vw, 24px);
            font-family: 'Noto Sans JP', sans-serif;
            transition: all 0.3s;
            text-align: center;
        }
        
        .option-btn:hover:not(:disabled) {
            border-color: #e94560;
            background: #fff5f7;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(233, 69, 96, 0.2);
        }
        
        .option-btn.correct {
            border-color: #4caf50;
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .option-btn.incorrect {
            border-color: #f44336;
            background: #ffebee;
            color: #c62828;
        }
        
        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        
        /* Feedback */
        .feedback {
            padding: clamp(12px, 2.5vw, 18px);
            border-radius: 12px;
            margin-top: 15px;
            display: none;
            font-size: clamp(14px, 2.2vw, 17px);
        }
        
        .feedback.correct {
            display: block;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left: 5px solid #4caf50;
            color: #2e7d32;
        }
        
        .feedback.incorrect {
            display: block;
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border-left: 5px solid #f44336;
            color: #c62828;
        }
        
        .feedback .correct-answer {
            font-size: clamp(20px, 3.5vw, 26px);
            font-weight: bold;
            margin-top: 10px;
        }
        
        .next-btn {
            padding: clamp(10px, 2vw, 14px) clamp(24px, 4vw, 35px);
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: clamp(14px, 2.2vw, 17px);
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .next-btn:hover {
            background: linear-gradient(135deg, #43a047, #5cb85c);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }
        
        /* Results Section */
        .results-card {
            text-align: center;
            padding: clamp(30px, 5vw, 50px);
        }
        
        .results-icon {
            font-size: clamp(60px, 12vw, 90px);
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: clamp(24px, 5vw, 36px);
            color: #0f3460;
            margin-bottom: 15px;
        }
        
        .results-score {
            font-size: clamp(40px, 8vw, 60px);
            font-weight: bold;
            color: #e94560;
            margin-bottom: 25px;
        }
        
        .results-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: clamp(10px, 2vw, 15px);
            margin: 25px 0;
        }
        
        .breakdown-item {
            background: #f8f9ff;
            padding: clamp(12px, 2vw, 18px);
            border-radius: 12px;
            border-left: 4px solid #e94560;
        }
        
        .breakdown-label {
            font-size: clamp(11px, 1.8vw, 14px);
            color: #666;
        }
        
        .breakdown-value {
            font-size: clamp(20px, 3.5vw, 28px);
            font-weight: bold;
            color: #0f3460;
        }
        
        .retry-btn {
            padding: clamp(14px, 2.5vw, 18px) clamp(35px, 6vw, 50px);
            background: linear-gradient(135deg, #e94560, #ff6b6b);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: clamp(16px, 2.5vw, 20px);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
        }
        
        .retry-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.4);
        }
        
        /* Notes Box */
        .note-box {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
            padding: clamp(12px, 2vw, 18px);
            border-radius: 12px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
            font-size: clamp(12px, 1.8vw, 15px);
        }
        
        .note-box::before {
            content: 'üìù ';
        }
        
        .warning-box {
            background: linear-gradient(135deg, #ffe0e6 0%, #ffd1d9 100%);
            padding: clamp(12px, 2vw, 18px);
            border-radius: 12px;
            margin: 15px 0;
            border-left: 4px solid #e94560;
            font-size: clamp(12px, 1.8vw, 15px);
        }
        
        .warning-box::before {
            content: '‚ö†Ô∏è ';
        }
        
        .tip-box {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            padding: clamp(12px, 2vw, 18px);
            border-radius: 12px;
            margin: 15px 0;
            border-left: 4px solid #28a745;
            font-size: clamp(12px, 1.8vw, 15px);
        }
        
        .tip-box::before {
            content: 'üí° ';
        }
        
        /* Irregular highlight */
        .irregular {
            color: #e94560;
            font-weight: bold;
        }
        
        /* Mobile touch feedback */
        @media (hover: none) {
            .option-btn:active {
                transform: scale(0.98);
            }
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üî¢ „Åò„Çá„Åô„ÅÜ„Åó „Çå„Çì„Åó„ÇÖ„ÅÜ</h1>
            <p>Japanese Counter Practice Quiz ‚Ä¢ 50 Questions</p>
        </div>
        
        <!-- Score Board -->
        <div class="score-board">
            <div class="score-item">
                <div class="score-label">„Å¶„Çì„Åô„ÅÜ</div>
                <div class="score-value" id="score">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">„Åó„Å§„ÇÇ„Çì</div>
                <div class="score-value"><span id="answered">0</span>/<span id="total">50</span></div>
            </div>
            <div class="score-item progress-container">
                <div class="score-label">„Åó„Çì„Å©</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress"></div>
                </div>
            </div>
        </div>
        
        <!-- Section Tabs -->
        <div class="section-tabs">
            <button class="tab-btn active" id="tab-basic" onclick="handleTabClick('basic')">üì¶ „Åç„Åª„Çì</button>
            <button class="tab-btn locked" id="tab-time" onclick="handleTabClick('time')">‚è∞ „Åò„Åã„Çì</button>
            <button class="tab-btn locked" id="tab-advanced" onclick="handleTabClick('advanced')">üìö „Åä„ÅÜ„Çà„ÅÜ</button>
            <button class="tab-btn locked" id="tab-mixed" onclick="handleTabClick('mixed')">üéØ „Åù„ÅÜ„Åî„ÅÜ</button>
        </div>
        
        <!-- Reference Toggle -->
        <div class="reference-toggle">
            <button class="reference-btn" onclick="toggleReference()">üìñ „Åò„Çá„Åô„ÅÜ„Åó „Å≤„Çá„ÅÜ „Çí„Åø„Çã</button>
        </div>
        
        <!-- Reference Card -->
        <div class="reference-card" id="referenceCard">
            <div class="ref-title">üìä „Åò„Çá„Åô„ÅÜ„Åó „Åï„Çì„Åì„ÅÜ „Å≤„Çá„ÅÜ (Counter Reference)</div>
            
            <div class="ref-grid">
                <div class="ref-box time">
                    <div class="ref-box-title">‚è∞ „Åò„Åã„Çì (Time)</div>
                    <div class="ref-box-content">
                        <span class="counter-tag">„Äú„Åò„Åã„Çì (hours)</span>
                        <span class="counter-tag">„Äú„Åµ„Çì/„Å∑„Çì (minutes)</span>
                        <span class="counter-tag">„Äú„Å´„Å° (days)</span>
                        <span class="counter-tag">„Äú„Åó„ÇÖ„ÅÜ„Åã„Çì (weeks)</span>
                        <span class="counter-tag">„Äú„Åã„Åí„Å§ (months)</span>
                        <span class="counter-tag">„Äú„Å≠„Çì (years)</span>
                    </div>
                    <div class="note-box" style="margin-top: 10px; font-size: 12px;">
                        <strong>„Åµ„Åç„Åù„Åè:</strong> „ÅÑ„Å£„Å∑„Çì„ÄÅ„Çç„Å£„Å∑„Çì„ÄÅ„ÅØ„Å£„Å∑„Çì„ÄÅ„Åò„ÇÖ„Å£„Å∑„Çì
                    </div>
                </div>
                
                <div class="ref-box things">
                    <div class="ref-box-title">üì¶ „ÇÇ„ÅÆ (Things)</div>
                    <div class="ref-box-content">
                        <span class="counter-tag">„Äú„Å§ (general)</span>
                        <span class="counter-tag">„Äú„Åì (small items)</span>
                        <span class="counter-tag">„Äú„Åæ„ÅÑ (flat things)</span>
                        <span class="counter-tag">„Äú„Åª„Çì/„Åº„Çì/„ÅΩ„Çì (long things)</span>
                        <span class="counter-tag">„Äú„Åï„Å§ (books)</span>
                        <span class="counter-tag">„Äú„Å†„ÅÑ (machines)</span>
                    </div>
                </div>
                
                <div class="ref-box people">
                    <div class="ref-box-title">üë• „Å≤„Å® (People)</div>
                    <div class="ref-box-content">
                        <span class="counter-tag">„Äú„Å´„Çì (people)</span>
                        <span class="counter-tag">„Äú„Åï„ÅÑ (age)</span>
                        <span class="counter-tag">„Äú„Å∞„Çì (order)</span>
                    </div>
                    <div class="warning-box" style="margin-top: 10px; font-size: 12px;">
                        <strong>„Åµ„Åç„Åù„Åè:</strong> „Å≤„Å®„Çä„ÄÅ„Åµ„Åü„Çä (not „ÅÑ„Å°„Å´„Çì„ÄÅ„Å´„Å´„Çì)
                    </div>
                </div>
                
                <div class="ref-box objects">
                    <div class="ref-box-title">üè† „Åü„Å¶„ÇÇ„ÅÆ„Éª„ÅÆ„Çä„ÇÇ„ÅÆ (Buildings & Vehicles)</div>
                    <div class="ref-box-content">
                        <span class="counter-tag">„Äú„Åã„ÅÑ (floors)</span>
                        <span class="counter-tag">„Äú„Åë„Çì (houses)</span>
                        <span class="counter-tag">„Äú„Åù„Åè (shoes/socks)</span>
                        <span class="counter-tag">„Äú„Å°„ÇÉ„Åè (clothes)</span>
                        <span class="counter-tag">„Äú„ÅØ„ÅÑ/„Å±„ÅÑ/„Å∞„ÅÑ (cups)</span>
                        <span class="counter-tag">„Äú„Åã„ÅÑ (frequency)</span>
                    </div>
                </div>
                
                <div class="ref-box animals">
                    <div class="ref-box-title">üê± „Å©„ÅÜ„Å∂„Å§ (Animals)</div>
                    <div class="ref-box-content">
                        <span class="counter-tag">„Äú„Å≤„Åç/„Å≥„Åç/„Å¥„Åç (small animals)</span>
                    </div>
                    <div class="tip-box" style="margin-top: 10px; font-size: 12px;">
                        <strong>„É´„Éº„É´:</strong> 1,6,8,10 ‚Üí „Å¥„Åç | 3 ‚Üí „Å≥„Åç | others ‚Üí „Å≤„Åç
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Basic Section (Things, People, General) -->
        <div class="quiz-section active" id="basic-section">
            <div class="card">
                <div class="card-title">üì¶ „Åç„Åª„Çì „Åò„Çá„Åô„ÅÜ„Åó (Basic Counters)</div>
                <div id="basic-question"></div>
            </div>
        </div>
        
        <!-- Time Section -->
        <div class="quiz-section" id="time-section">
            <div class="card">
                <div class="card-title">‚è∞ „Åò„Åã„Çì „ÅÆ „Åò„Çá„Åô„ÅÜ„Åó (Time Counters)</div>
                <div id="time-question"></div>
            </div>
        </div>
        
        <!-- Advanced Section -->
        <div class="quiz-section" id="advanced-section">
            <div class="card">
                <div class="card-title">üìö „Åä„ÅÜ„Çà„ÅÜ „Åò„Çá„Åô„ÅÜ„Åó (Advanced Counters)</div>
                <div id="advanced-question"></div>
            </div>
        </div>
        
        <!-- Mixed Section -->
        <div class="quiz-section" id="mixed-section">
            <div class="card">
                <div class="card-title">üéØ „Åù„ÅÜ„Åî„ÅÜ „ÇÇ„Çì„Å†„ÅÑ (Mixed Questions)</div>
                <div id="mixed-question"></div>
            </div>
        </div>
        
        <!-- Results Section -->
        <div class="quiz-section" id="results-section">
            <div class="card results-card">
                <div class="results-icon" id="results-icon">üéâ</div>
                <div class="results-title" id="results-title">„Åô„Å∞„Çâ„Åó„ÅÑÔºÅ</div>
                <div class="results-score" id="final-score">0%</div>
                
                <div class="results-breakdown">
                    <div class="breakdown-item">
                        <div class="breakdown-label">üì¶ „Åç„Åª„Çì</div>
                        <div class="breakdown-value" id="basic-score">0/0</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="breakdown-label">‚è∞ „Åò„Åã„Çì</div>
                        <div class="breakdown-value" id="time-score">0/0</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="breakdown-label">üìö „Åä„ÅÜ„Çà„ÅÜ</div>
                        <div class="breakdown-value" id="advanced-score">0/0</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="breakdown-label">üéØ „Åù„ÅÜ„Åî„ÅÜ</div>
                        <div class="breakdown-value" id="mixed-score">0/0</div>
                    </div>
                </div>
                
                <button class="retry-btn" onclick="restartQuiz()">üîÑ „ÇÇ„ÅÜ„ÅÑ„Å°„Å©</button>
            </div>
        </div>
    </div>
    
    <script>
        // ==================== COUNTER DATA ====================
        
        // General counter („Å§)
        const tsuCounter = {
            name: '„Å§',
            emoji: 'üì¶',
            category: 'things',
            readings: {
                1: '„Å≤„Å®„Å§', 2: '„Åµ„Åü„Å§', 3: '„Åø„Å£„Å§', 4: '„Çà„Å£„Å§', 5: '„ÅÑ„Å§„Å§',
                6: '„ÇÄ„Å£„Å§', 7: '„Å™„Å™„Å§', 8: '„ÇÑ„Å£„Å§', 9: '„Åì„Åì„ÅÆ„Å§', 10: '„Å®„Åä', '?': '„ÅÑ„Åè„Å§'
            },
            irregulars: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
        };
        
        // People counter (‰∫∫)
        const ninCounter = {
            name: '„Å´„Çì',
            emoji: 'üë•',
            category: 'people',
            readings: {
                1: '„Å≤„Å®„Çä', 2: '„Åµ„Åü„Çä', 3: '„Åï„Çì„Å´„Çì', 4: '„Çà„Å´„Çì', 5: '„Åî„Å´„Çì',
                6: '„Çç„Åè„Å´„Çì', 7: '„Å™„Å™„Å´„Çì / „Åó„Å°„Å´„Çì', 8: '„ÅØ„Å°„Å´„Çì', 9: '„Åç„ÇÖ„ÅÜ„Å´„Çì', 10: '„Åò„ÇÖ„ÅÜ„Å´„Çì', '?': '„Å™„Çì„Å´„Çì'
            },
            irregulars: [1, 2, 4, 7]
        };
        
        // Order counter (Áï™)
        const banCounter = {
            name: '„Å∞„Çì',
            emoji: 'üèÜ',
            category: 'people',
            readings: {
                1: '„ÅÑ„Å°„Å∞„Çì', 2: '„Å´„Å∞„Çì', 3: '„Åï„Çì„Å∞„Çì', 4: '„Çà„Çì„Å∞„Çì', 5: '„Åî„Å∞„Çì',
                6: '„Çç„Åè„Å∞„Çì', 7: '„Å™„Å™„Å∞„Çì', 8: '„ÅØ„Å°„Å∞„Çì', 9: '„Åç„ÇÖ„ÅÜ„Å∞„Çì', 10: '„Åò„ÇÖ„ÅÜ„Å∞„Çì', '?': '„Å™„Çì„Å∞„Çì'
            },
            irregulars: []
        };
        
        // Flat things counter (Êûö)
        const maiCounter = {
            name: '„Åæ„ÅÑ',
            emoji: 'üìÑ',
            category: 'things',
            readings: {
                1: '„ÅÑ„Å°„Åæ„ÅÑ', 2: '„Å´„Åæ„ÅÑ', 3: '„Åï„Çì„Åæ„ÅÑ', 4: '„Çà„Çì„Åæ„ÅÑ', 5: '„Åî„Åæ„ÅÑ',
                6: '„Çç„Åè„Åæ„ÅÑ', 7: '„Å™„Å™„Åæ„ÅÑ', 8: '„ÅØ„Å°„Åæ„ÅÑ', 9: '„Åç„ÇÖ„ÅÜ„Åæ„ÅÑ', 10: '„Åò„ÇÖ„ÅÜ„Åæ„ÅÑ', '?': '„Å™„Çì„Åæ„ÅÑ'
            },
            irregulars: []
        };
        
        // Machines/vehicles counter (Âè∞)
        const daiCounter = {
            name: '„Å†„ÅÑ',
            emoji: 'üöó',
            category: 'objects',
            readings: {
                1: '„ÅÑ„Å°„Å†„ÅÑ', 2: '„Å´„Å†„ÅÑ', 3: '„Åï„Çì„Å†„ÅÑ', 4: '„Çà„Çì„Å†„ÅÑ', 5: '„Åî„Å†„ÅÑ',
                6: '„Çç„Åè„Å†„ÅÑ', 7: '„Å™„Å™„Å†„ÅÑ', 8: '„ÅØ„Å°„Å†„ÅÑ', 9: '„Åç„ÇÖ„ÅÜ„Å†„ÅÑ', 10: '„Åò„ÇÖ„ÅÜ„Å†„ÅÑ', '?': '„Å™„Çì„Å†„ÅÑ'
            },
            irregulars: []
        };
        
        // Age counter (Ê≠≥)
        const saiCounter = {
            name: '„Åï„ÅÑ',
            emoji: 'üéÇ',
            category: 'people',
            readings: {
                1: '„ÅÑ„Å£„Åï„ÅÑ', 2: '„Å´„Åï„ÅÑ', 3: '„Åï„Çì„Åï„ÅÑ', 4: '„Çà„Çì„Åï„ÅÑ', 5: '„Åî„Åï„ÅÑ',
                6: '„Çç„Åè„Åï„ÅÑ', 7: '„Å™„Å™„Åï„ÅÑ', 8: '„ÅØ„Å£„Åï„ÅÑ', 9: '„Åç„ÇÖ„ÅÜ„Åï„ÅÑ', 10: '„Åò„ÇÖ„Å£„Åï„ÅÑ / „Åò„Å£„Åï„ÅÑ', '?': '„Å™„Çì„Åï„ÅÑ'
            },
            irregulars: [1, 8, 10]
        };
        
        // Books counter (ÂÜä)
        const satsuCounter = {
            name: '„Åï„Å§',
            emoji: 'üìö',
            category: 'things',
            readings: {
                1: '„ÅÑ„Å£„Åï„Å§', 2: '„Å´„Åï„Å§', 3: '„Åï„Çì„Åï„Å§', 4: '„Çà„Çì„Åï„Å§', 5: '„Åî„Åï„Å§',
                6: '„Çç„Åè„Åï„Å§', 7: '„Å™„Å™„Åï„Å§', 8: '„ÅØ„Å£„Åï„Å§', 9: '„Åç„ÇÖ„ÅÜ„Åï„Å§', 10: '„Åò„ÇÖ„Å£„Åï„Å§', '?': '„Å™„Çì„Åï„Å§'
            },
            irregulars: [1, 8, 10]
        };
        
        // Clothes counter (ÁùÄ)
        const chakuCounter = {
            name: '„Å°„ÇÉ„Åè',
            emoji: 'üëî',
            category: 'objects',
            readings: {
                1: '„ÅÑ„Å£„Å°„ÇÉ„Åè', 2: '„Å´„Å°„ÇÉ„Åè', 3: '„Åï„Çì„Å°„ÇÉ„Åè', 4: '„Çà„Çì„Å°„ÇÉ„Åè', 5: '„Åî„Å°„ÇÉ„Åè',
                6: '„Çç„Åè„Å°„ÇÉ„Åè', 7: '„Å™„Å™„Å°„ÇÉ„Åè', 8: '„ÅØ„Å£„Å°„ÇÉ„Åè', 9: '„Åç„ÇÖ„ÅÜ„Å°„ÇÉ„Åè', 10: '„Åò„ÇÖ„Å£„Å°„ÇÉ„Åè / „Åò„Å£„Å°„ÇÉ„Åè', '?': '„Å™„Çì„Å°„ÇÉ„Åè'
            },
            irregulars: [1, 8, 10]
        };
        
        // Hours counter (ÊôÇÈñì)
        const jikanCounter = {
            name: '„Åò„Åã„Çì',
            emoji: '‚è∞',
            category: 'time',
            readings: {
                1: '„ÅÑ„Å°„Åò„Åã„Çì', 2: '„Å´„Åò„Åã„Çì', 3: '„Åï„Çì„Åò„Åã„Çì', 4: '„Çà„Åò„Åã„Çì', 5: '„Åî„Åò„Åã„Çì',
                6: '„Çç„Åè„Åò„Åã„Çì', 7: '„Å™„Å™„Åò„Åã„Çì / „Åó„Å°„Åò„Åã„Çì', 8: '„ÅØ„Å°„Åò„Åã„Çì', 9: '„Åè„Åò„Åã„Çì', 10: '„Åò„ÇÖ„ÅÜ„Åò„Åã„Çì', '?': '„Å™„Çì„Åò„Åã„Çì'
            },
            irregulars: [4, 7, 9]
        };
        
        // Minutes counter (ÂàÜ)
        const funCounter = {
            name: '„Åµ„Çì / „Å∑„Çì',
            emoji: '‚è±Ô∏è',
            category: 'time',
            readings: {
                1: '„ÅÑ„Å£„Å∑„Çì', 2: '„Å´„Åµ„Çì', 3: '„Åï„Çì„Å∑„Çì', 4: '„Çà„Çì„Å∑„Çì', 5: '„Åî„Åµ„Çì',
                6: '„Çç„Å£„Å∑„Çì', 7: '„Å™„Å™„Åµ„Çì', 8: '„ÅØ„Å£„Å∑„Çì', 9: '„Åç„ÇÖ„ÅÜ„Åµ„Çì', 10: '„Åò„ÇÖ„Å£„Å∑„Çì / „Åò„Å£„Å∑„Çì', '?': '„Å™„Çì„Å∑„Çì'
            },
            irregulars: [1, 3, 4, 6, 8, 10]
        };
        
        // Days counter (Êó•)
        const nichiCounter = {
            name: '„Å´„Å°',
            emoji: 'üìÖ',
            category: 'time',
            readings: {
                1: '„ÅÑ„Å°„Å´„Å°', 2: '„Åµ„Å§„Åã', 3: '„Åø„Å£„Åã', 4: '„Çà„Å£„Åã', 5: '„ÅÑ„Å§„Åã',
                6: '„ÇÄ„ÅÑ„Åã', 7: '„Å™„ÅÆ„Åã', 8: '„Çà„ÅÜ„Åã', 9: '„Åì„Åì„ÅÆ„Åã', 10: '„Å®„Åä„Åã', '?': '„Å™„Çì„Å´„Å°'
            },
            irregulars: [2, 3, 4, 5, 6, 7, 8, 9, 10]
        };
        
        // Weeks counter (ÈÄ±Èñì)
        const shukanCounter = {
            name: '„Åó„ÇÖ„ÅÜ„Åã„Çì',
            emoji: 'üìÜ',
            category: 'time',
            readings: {
                1: '„ÅÑ„Å£„Åó„ÇÖ„ÅÜ„Åã„Çì', 2: '„Å´„Åó„ÇÖ„ÅÜ„Åã„Çì', 3: '„Åï„Çì„Åó„ÇÖ„ÅÜ„Åã„Çì', 4: '„Çà„Çì„Åó„ÇÖ„ÅÜ„Åã„Çì', 5: '„Åî„Åó„ÇÖ„ÅÜ„Åã„Çì',
                6: '„Çç„Åè„Åó„ÇÖ„ÅÜ„Åã„Çì', 7: '„Å™„Å™„Åó„ÇÖ„ÅÜ„Åã„Çì', 8: '„ÅØ„Å£„Åó„ÇÖ„ÅÜ„Åã„Çì', 9: '„Åç„ÇÖ„ÅÜ„Åó„ÇÖ„ÅÜ„Åã„Çì', 10: '„Åò„ÇÖ„Å£„Åó„ÇÖ„ÅÜ„Åã„Çì', '?': '„Å™„Çì„Åó„ÇÖ„ÅÜ„Åã„Çì'
            },
            irregulars: [1, 8, 10]
        };
        
        // Months counter („ÅãÊúà)
        const kagetsuCounter = {
            name: '„Åã„Åí„Å§',
            emoji: 'üóìÔ∏è',
            category: 'time',
            readings: {
                1: '„ÅÑ„Å£„Åã„Åí„Å§', 2: '„Å´„Åã„Åí„Å§', 3: '„Åï„Çì„Åã„Åí„Å§', 4: '„Çà„Çì„Åã„Åí„Å§', 5: '„Åî„Åã„Åí„Å§',
                6: '„Çç„Å£„Åã„Åí„Å§', 7: '„Å™„Å™„Åã„Åí„Å§', 8: '„ÅØ„Å°„Åã„Åí„Å§ / „ÅØ„Å£„Åã„Åí„Å§', 9: '„Åç„ÇÖ„ÅÜ„Åã„Åí„Å§', 10: '„Åò„ÇÖ„Å£„Åã„Åí„Å§', '?': '„Å™„Çì„Åã„Åí„Å§'
            },
            irregulars: [1, 6, 8, 10]
        };
        
        // Years counter (Âπ¥)
        const nenCounter = {
            name: '„Å≠„Çì',
            emoji: 'üìÖ',
            category: 'time',
            readings: {
                1: '„ÅÑ„Å°„Å≠„Çì', 2: '„Å´„Å≠„Çì', 3: '„Åï„Çì„Å≠„Çì', 4: '„Çà„Å≠„Çì', 5: '„Åî„Å≠„Çì',
                6: '„Çç„Åè„Å≠„Çì', 7: '„Å™„Å™„Å≠„Çì / „Åó„Å°„Å≠„Çì', 8: '„ÅØ„Å°„Å≠„Çì', 9: '„Åç„ÇÖ„ÅÜ„Å≠„Çì', 10: '„Åò„ÇÖ„ÅÜ„Å≠„Çì', '?': '„Å™„Çì„Å≠„Çì'
            },
            irregulars: [4, 7]
        };
        
        // Frequency counter (Âõû)
        const kaiCounter = {
            name: '„Åã„ÅÑ',
            emoji: 'üîÑ',
            category: 'objects',
            readings: {
                1: '„ÅÑ„Å£„Åã„ÅÑ', 2: '„Å´„Åã„ÅÑ', 3: '„Åï„Çì„Åã„ÅÑ', 4: '„Çà„Çì„Åã„ÅÑ', 5: '„Åî„Åã„ÅÑ',
                6: '„Çç„Å£„Åã„ÅÑ', 7: '„Å™„Å™„Åã„ÅÑ', 8: '„ÅØ„Å£„Åã„ÅÑ', 9: '„Åç„ÇÖ„ÅÜ„Åã„ÅÑ', 10: '„Åò„ÇÖ„Å£„Åã„ÅÑ', '?': '„Å™„Çì„Åã„ÅÑ'
            },
            irregulars: [1, 6, 8, 10]
        };
        
        // Small things counter (ÂÄã)
        const koCounter = {
            name: '„Åì',
            emoji: 'üîµ',
            category: 'things',
            readings: {
                1: '„ÅÑ„Å£„Åì', 2: '„Å´„Åì', 3: '„Åï„Çì„Åì', 4: '„Çà„Çì„Åì', 5: '„Åî„Åì',
                6: '„Çç„Å£„Åì', 7: '„Å™„Å™„Åì', 8: '„ÅØ„Å£„Åì', 9: '„Åç„ÇÖ„ÅÜ„Åì', 10: '„Åò„ÇÖ„Å£„Åì', '?': '„Å™„Çì„Åì'
            },
            irregulars: [1, 6, 8, 10]
        };
        
        // Shoes/socks counter (Ë∂≥)
        const sokuCounter = {
            name: '„Åù„Åè',
            emoji: 'üëü',
            category: 'objects',
            readings: {
                1: '„ÅÑ„Å£„Åù„Åè', 2: '„Å´„Åù„Åè', 3: '„Åï„Çì„Åû„Åè', 4: '„Çà„Çì„Åù„Åè', 5: '„Åî„Åù„Åè',
                6: '„Çç„Åè„Åù„Åè', 7: '„Å™„Å™„Åù„Åè', 8: '„ÅØ„Å£„Åù„Åè', 9: '„Åç„ÇÖ„ÅÜ„Åù„Åè', 10: '„Åò„ÇÖ„Å£„Åù„Åè / „Åò„Å£„Åù„Åè', '?': '„Å™„Çì„Åù„Åè'
            },
            irregulars: [1, 3, 8, 10]
        };
        
        // Houses counter (Ëªí)
        const kenCounter = {
            name: '„Åë„Çì',
            emoji: 'üè†',
            category: 'objects',
            readings: {
                1: '„ÅÑ„Å£„Åë„Çì', 2: '„Å´„Åë„Çì', 3: '„Åï„Çì„Åí„Çì', 4: '„Çà„Çì„Åë„Çì', 5: '„Åî„Åë„Çì',
                6: '„Çç„Å£„Åë„Çì', 7: '„Å™„Å™„Åë„Çì', 8: '„ÅØ„Å£„Åë„Çì', 9: '„Åç„ÇÖ„ÅÜ„Åë„Çì', 10: '„Åò„ÇÖ„Å£„Åë„Çì / „Åò„Å£„Åë„Çì', '?': '„Å™„Çì„Åí„Çì'
            },
            irregulars: [1, 3, 6, 8, 10]
        };
        
        // Floors counter (Èöé)
        const kaiFloorCounter = {
            name: '„Åã„ÅÑ (floors)',
            emoji: 'üè¢',
            category: 'objects',
            readings: {
                1: '„ÅÑ„Å£„Åã„ÅÑ', 2: '„Å´„Åã„ÅÑ', 3: '„Åï„Çì„Åå„ÅÑ', 4: '„Çà„Çì„Åã„ÅÑ', 5: '„Åî„Åã„ÅÑ',
                6: '„Çç„Å£„Åã„ÅÑ', 7: '„Å™„Å™„Åã„ÅÑ', 8: '„ÅØ„Å£„Åã„ÅÑ', 9: '„Åç„ÇÖ„ÅÜ„Åã„ÅÑ', 10: '„Åò„ÇÖ„Å£„Åã„ÅÑ / „Åò„Å£„Åã„ÅÑ', '?': '„Å™„Çì„Åå„ÅÑ'
            },
            irregulars: [1, 3, 6, 8, 10]
        };
        
        // Long things counter (Êú¨)
        const honCounter = {
            name: '„Åª„Çì / „Åº„Çì / „ÅΩ„Çì',
            emoji: 'üñäÔ∏è',
            category: 'things',
            readings: {
                1: '„ÅÑ„Å£„ÅΩ„Çì', 2: '„Å´„Åª„Çì', 3: '„Åï„Çì„Åº„Çì', 4: '„Çà„Çì„Åª„Çì', 5: '„Åî„Åª„Çì',
                6: '„Çç„Å£„ÅΩ„Çì', 7: '„Å™„Å™„Åª„Çì', 8: '„ÅØ„Å£„ÅΩ„Çì / „ÅØ„Å°„Åª„Çì', 9: '„Åç„ÇÖ„ÅÜ„Åª„Çì', 10: '„Åò„ÇÖ„Å£„ÅΩ„Çì', '?': '„Å™„Çì„Åº„Çì'
            },
            irregulars: [1, 3, 6, 8, 10]
        };
        
        // Cups counter (ÊùØ)
        const haiCounter = {
            name: '„ÅØ„ÅÑ / „Å∞„ÅÑ / „Å±„ÅÑ',
            emoji: '‚òï',
            category: 'objects',
            readings: {
                1: '„ÅÑ„Å£„Å±„ÅÑ', 2: '„Å´„ÅØ„ÅÑ', 3: '„Åï„Çì„Å∞„ÅÑ', 4: '„Çà„Çì„ÅØ„ÅÑ', 5: '„Åî„ÅØ„ÅÑ',
                6: '„Çç„Å£„Å±„ÅÑ', 7: '„Å™„Å™„ÅØ„ÅÑ', 8: '„ÅØ„Å£„Å±„ÅÑ / „ÅØ„Å°„ÅØ„ÅÑ', 9: '„Åç„ÇÖ„ÅÜ„ÅØ„ÅÑ', 10: '„Åò„ÇÖ„Å£„Å±„ÅÑ', '?': '„Å™„Çì„Å∞„ÅÑ'
            },
            irregulars: [1, 3, 6, 8, 10]
        };
        
        // Small animals counter (Âåπ)
        const hikiCounter = {
            name: '„Å≤„Åç / „Å≥„Åç / „Å¥„Åç',
            emoji: 'üê±',
            category: 'animals',
            readings: {
                1: '„ÅÑ„Å£„Å¥„Åç', 2: '„Å´„Å≤„Åç', 3: '„Åï„Çì„Å≥„Åç', 4: '„Çà„Çì„Å≤„Åç', 5: '„Åî„Å≤„Åç',
                6: '„Çç„Å£„Å¥„Åç', 7: '„Å™„Å™„Å≤„Åç', 8: '„ÅØ„Å£„Å¥„Åç', 9: '„Åç„ÇÖ„ÅÜ„Å≤„Åç', 10: '„Åò„ÇÖ„Å£„Å¥„Åç', '?': '„Å™„Çì„Å≥„Åç'
            },
            irregulars: [1, 3, 6, 8, 10]
        };
        
        // Group counters by section
        const basicCounters = [tsuCounter, ninCounter, koCounter, maiCounter, banCounter];
        const timeCounters = [jikanCounter, funCounter, nichiCounter, shukanCounter, kagetsuCounter, nenCounter];
        const advancedCounters = [satsuCounter, daiCounter, saiCounter, chakuCounter, honCounter, haiCounter, hikiCounter, sokuCounter, kenCounter, kaiFloorCounter, kaiCounter];
        const allCounters = [...basicCounters, ...timeCounters, ...advancedCounters];
        
        // ==================== GAME STATE ====================
        
        let currentSection = 'basic';
        let currentQuestion = 0;
        let score = 0;
        let questionsAnswered = 0;
        const totalQuestions = 50;
        
        let sectionStatus = {
            basic: { completed: false, correct: 0, total: 12 },
            time: { completed: false, correct: 0, total: 14 },
            advanced: { completed: false, correct: 0, total: 12 },
            mixed: { completed: false, correct: 0, total: 12 }
        };
        
        let basicQuestions = [];
        let timeQuestions = [];
        let advancedQuestions = [];
        let mixedQuestions = [];
        
        // ==================== QUESTION GENERATION ====================
        
        function generateQuestion(counter, number) {
            const correctAnswer = counter.readings[number];
            const isIrregular = counter.irregulars.includes(number);
            
            // Generate wrong answers
            const wrongAnswers = [];
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            const shuffledNumbers = numbers.filter(n => n !== number).sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < 3 && i < shuffledNumbers.length; i++) {
                wrongAnswers.push(counter.readings[shuffledNumbers[i]]);
            }
            
            return {
                counter: counter,
                number: number,
                correctAnswer: correctAnswer,
                wrongAnswers: wrongAnswers,
                isIrregular: isIrregular
            };
        }
        
        function generateSectionQuestions(counters, count) {
            const questions = [];
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            
            while (questions.length < count) {
                const counter = counters[Math.floor(Math.random() * counters.length)];
                const number = numbers[Math.floor(Math.random() * numbers.length)];
                
                // Avoid too many duplicates
                const existingCount = questions.filter(q => 
                    q.counter.name === counter.name && q.number === number
                ).length;
                
                if (existingCount < 1) {
                    questions.push(generateQuestion(counter, number));
                }
            }
            
            return questions.sort(() => Math.random() - 0.5);
        }
        
        function init() {
            // Generate questions for each section
            basicQuestions = generateSectionQuestions(basicCounters, sectionStatus.basic.total);
            timeQuestions = generateSectionQuestions(timeCounters, sectionStatus.time.total);
            advancedQuestions = generateSectionQuestions(advancedCounters, sectionStatus.advanced.total);
            mixedQuestions = generateSectionQuestions(allCounters, sectionStatus.mixed.total);
            
            document.getElementById('total').textContent = totalQuestions;
            updateScoreBoard();
            loadQuestion();
        }
        
        // ==================== QUESTION LOADING ====================
        
        function loadQuestion() {
            let questions, elementId;
            
            switch (currentSection) {
                case 'basic':
                    questions = basicQuestions;
                    elementId = 'basic-question';
                    break;
                case 'time':
                    questions = timeQuestions;
                    elementId = 'time-question';
                    break;
                case 'advanced':
                    questions = advancedQuestions;
                    elementId = 'advanced-question';
                    break;
                case 'mixed':
                    questions = mixedQuestions;
                    elementId = 'mixed-question';
                    break;
            }
            
            if (currentQuestion >= questions.length) {
                showSectionComplete();
                return;
            }
            
            const q = questions[currentQuestion];
            const allOptions = [q.correctAnswer, ...q.wrongAnswers].sort(() => Math.random() - 0.5);
            
            const irregularNote = q.isIrregular ? 
                `<div class="warning-box" style="text-align: center; margin: 10px 0;">„Åµ„Åç„Åù„Åè „Åë„ÅÑ (Irregular Form)</div>` : '';
            
            document.getElementById(elementId).innerHTML = `
                <div class="question-box">
                    <div class="question-number">„ÇÇ„Çì„Å†„ÅÑ ${currentQuestion + 1} / ${questions.length}</div>
                    
                    <div class="question-context">
                        <span class="counter-emoji">${q.counter.emoji}</span>
                        <div>
                            <div class="question-text">${getCounterDescription(q.counter)}</div>
                            <span class="counter-indicator ${q.counter.category}">${q.counter.name}</span>
                        </div>
                    </div>
                    
                    <div class="number-display">
                        <div class="number-badge">${q.number}</div>
                    </div>
                    
                    ${irregularNote}
                    
                    <div class="question-text">„Åì„ÅÆ „Åô„ÅÜ„Åò „ÅØ „Å™„Çì„Å® „Çà„Åø„Åæ„Åô„ÅãÔºü</div>
                    
                    <div class="options-grid" id="options-${currentSection}">
                        ${allOptions.map(opt => `
                            <button class="option-btn" data-answer="${opt}">${opt}</button>
                        `).join('')}
                    </div>
                    
                    <div class="feedback" id="feedback-${currentSection}"></div>
                </div>
            `;
            
            // Add event listeners
            document.querySelectorAll(`#options-${currentSection} .option-btn`).forEach(btn => {
                btn.addEventListener('click', function() {
                    checkAnswer(this, this.dataset.answer, q.correctAnswer);
                });
            });
        }
        
        function getCounterDescription(counter) {
            const descriptions = {
                '„Å§': 'General things',
                '„Å´„Çì': 'People',
                '„Å∞„Çì': 'Order/Ranking',
                '„Åæ„ÅÑ': 'Flat things (paper, shirts)',
                '„Å†„ÅÑ': 'Machines & vehicles',
                '„Åï„ÅÑ': 'Age',
                '„Åï„Å§': 'Books & notebooks',
                '„Å°„ÇÉ„Åè': 'Clothes',
                '„Åò„Åã„Çì': 'Hours (duration)',
                '„Åµ„Çì / „Å∑„Çì': 'Minutes',
                '„Å´„Å°': 'Days',
                '„Åó„ÇÖ„ÅÜ„Åã„Çì': 'Weeks',
                '„Åã„Åí„Å§': 'Months',
                '„Å≠„Çì': 'Years',
                '„Åã„ÅÑ': 'Frequency (times)',
                '„Åì': 'Small things',
                '„Åù„Åè': 'Pairs (shoes, socks)',
                '„Åë„Çì': 'Houses & buildings',
                '„Åã„ÅÑ (floors)': 'Floors of a building',
                '„Åª„Çì / „Åº„Çì / „ÅΩ„Çì': 'Long thin things',
                '„ÅØ„ÅÑ / „Å∞„ÅÑ / „Å±„ÅÑ': 'Cups & glasses',
                '„Å≤„Åç / „Å≥„Åç / „Å¥„Åç': 'Small animals'
            };
            return descriptions[counter.name] || counter.name;
        }
        
        // ==================== ANSWER CHECKING ====================
        
        function checkAnswer(btn, selected, correct) {
            const buttons = document.querySelectorAll(`#options-${currentSection} .option-btn`);
            buttons.forEach(b => b.disabled = true);
            
            // Handle answers that might have multiple correct forms (e.g., "„Åò„ÇÖ„Å£„Åï„ÅÑ / „Åò„Å£„Åï„ÅÑ")
            const correctAnswers = correct.split(' / ').map(a => a.trim());
            const isCorrect = correctAnswers.some(ans => selected.includes(ans) || ans.includes(selected)) || selected === correct;
            
            if (isCorrect) {
                btn.classList.add('correct');
                score += 10;
                sectionStatus[currentSection].correct++;
            } else {
                btn.classList.add('incorrect');
                buttons.forEach(b => {
                    if (b.dataset.answer === correct) {
                        b.classList.add('correct');
                    }
                });
            }
            
            questionsAnswered++;
            updateScoreBoard();
            
            const feedback = document.getElementById(`feedback-${currentSection}`);
            if (isCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = `
                    ‚úÖ „Åõ„ÅÑ„Åã„ÅÑÔºÅ„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ
                    <button class="next-btn" onclick="nextQuestion()">„Å§„Åé„Å∏ ‚Üí</button>
                `;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `
                    ‚ùå „Åñ„Çì„Å≠„ÇìÔºÅ
                    <div class="correct-answer">„Åì„Åü„Åà: ${correct}</div>
                    <button class="next-btn" onclick="nextQuestion()">„Å§„Åé„Å∏ ‚Üí</button>
                `;
            }
        }
        
        function nextQuestion() {
            currentQuestion++;
            loadQuestion();
        }
        
        // ==================== SECTION MANAGEMENT ====================
        
        function showSectionComplete() {
            sectionStatus[currentSection].completed = true;
            document.getElementById(`tab-${currentSection}`).classList.remove('active');
            document.getElementById(`tab-${currentSection}`).classList.add('completed');
            
            const nextSection = getNextSection();
            
            if (nextSection) {
                // Show completion message then move to next section
                const elementId = `${currentSection}-question`;
                const sectionCorrect = sectionStatus[currentSection].correct;
                const sectionTotal = sectionStatus[currentSection].total;
                
                document.getElementById(elementId).innerHTML = `
                    <div style="text-align: center; padding: 30px;">
                        <div style="font-size: 60px; margin-bottom: 15px;">üéä</div>
                        <div style="font-size: 24px; color: #4caf50; margin-bottom: 10px;">„Çª„ÇØ„Ç∑„Éß„É≥ „Åã„Çì„Çä„Çá„ÅÜÔºÅ</div>
                        <div style="font-size: 18px; color: #666; margin-bottom: 20px;">
                            ${sectionCorrect} / ${sectionTotal} „Åõ„ÅÑ„Åã„ÅÑ
                        </div>
                        <button class="next-btn" onclick="switchToSection('${nextSection}')" style="font-size: 18px; padding: 15px 35px;">
                            „Å§„Åé„ÅÆ „Çª„ÇØ„Ç∑„Éß„É≥„Å∏ ‚Üí
                        </button>
                    </div>
                `;
            } else {
                showResults();
            }
        }
        
        function getNextSection() {
            const sections = ['basic', 'time', 'advanced', 'mixed'];
            const currentIndex = sections.indexOf(currentSection);
            
            for (let i = currentIndex + 1; i < sections.length; i++) {
                if (!sectionStatus[sections[i]].completed) {
                    return sections[i];
                }
            }
            return null;
        }
        
        function handleTabClick(section) {
            const tab = document.getElementById('tab-' + section);
            if (tab.classList.contains('completed') || tab.classList.contains('locked')) {
                return;
            }
        }
        
        function switchToSection(section) {
            // Update tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('tab-' + section).classList.add('active');
            document.getElementById('tab-' + section).classList.remove('locked');
            
            // Update sections
            document.querySelectorAll('.quiz-section').forEach(s => s.classList.remove('active'));
            document.getElementById(section + '-section').classList.add('active');
            
            currentSection = section;
            currentQuestion = 0;
            loadQuestion();
        }
        
        // ==================== RESULTS ====================
        
        function showResults() {
            document.querySelectorAll('.quiz-section').forEach(s => s.classList.remove('active'));
            document.getElementById('results-section').classList.add('active');
            
            const totalCorrect = sectionStatus.basic.correct + sectionStatus.time.correct + 
                                sectionStatus.advanced.correct + sectionStatus.mixed.correct;
            const percentage = Math.round((totalCorrect / totalQuestions) * 100);
            
            document.getElementById('final-score').textContent = percentage + '%';
            document.getElementById('basic-score').textContent = `${sectionStatus.basic.correct}/${sectionStatus.basic.total}`;
            document.getElementById('time-score').textContent = `${sectionStatus.time.correct}/${sectionStatus.time.total}`;
            document.getElementById('advanced-score').textContent = `${sectionStatus.advanced.correct}/${sectionStatus.advanced.total}`;
            document.getElementById('mixed-score').textContent = `${sectionStatus.mixed.correct}/${sectionStatus.mixed.total}`;
            
            if (percentage >= 80) {
                document.getElementById('results-icon').textContent = 'üéâ';
                document.getElementById('results-title').textContent = '„Åô„Å∞„Çâ„Åó„ÅÑÔºÅ Excellent!';
            } else if (percentage >= 60) {
                document.getElementById('results-icon').textContent = 'üëç';
                document.getElementById('results-title').textContent = '„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ Good Job!';
            } else {
                document.getElementById('results-icon').textContent = 'üìö';
                document.getElementById('results-title').textContent = '„ÇÇ„Å£„Å® „Çå„Çì„Åó„ÇÖ„ÅÜ „Åó„Åæ„Åó„Çá„ÅÜÔºÅ';
            }
        }
        
        function restartQuiz() {
            currentSection = 'basic';
            currentQuestion = 0;
            score = 0;
            questionsAnswered = 0;
            
            sectionStatus = {
                basic: { completed: false, correct: 0, total: 12 },
                time: { completed: false, correct: 0, total: 14 },
                advanced: { completed: false, correct: 0, total: 12 },
                mixed: { completed: false, correct: 0, total: 12 }
            };
            
            // Regenerate questions (randomized)
            basicQuestions = generateSectionQuestions(basicCounters, sectionStatus.basic.total);
            timeQuestions = generateSectionQuestions(timeCounters, sectionStatus.time.total);
            advancedQuestions = generateSectionQuestions(advancedCounters, sectionStatus.advanced.total);
            mixedQuestions = generateSectionQuestions(allCounters, sectionStatus.mixed.total);
            
            // Reset tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active', 'completed', 'locked');
            });
            document.getElementById('tab-basic').classList.add('active');
            document.getElementById('tab-time').classList.add('locked');
            document.getElementById('tab-advanced').classList.add('locked');
            document.getElementById('tab-mixed').classList.add('locked');
            
            // Reset sections
            document.querySelectorAll('.quiz-section').forEach(s => s.classList.remove('active'));
            document.getElementById('basic-section').classList.add('active');
            
            updateScoreBoard();
            loadQuestion();
        }
        
        // ==================== UI UPDATES ====================
        
        function updateScoreBoard() {
            document.getElementById('score').textContent = score;
            document.getElementById('answered').textContent = questionsAnswered;
            
            const progress = (questionsAnswered / totalQuestions) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }
        
        function toggleReference() {
            const card = document.getElementById('referenceCard');
            card.classList.toggle('show');
            const btn = document.querySelector('.reference-btn');
            btn.textContent = card.classList.contains('show') ? 'üìñ „Åò„Çá„Åô„ÅÜ„Åó „Å≤„Çá„ÅÜ „Çí„Åã„Åè„Åô' : 'üìñ „Åò„Çá„Åô„ÅÜ„Åó „Å≤„Çá„ÅÜ „Çí„Åø„Çã';
        }
        
        // ==================== KEYBOARD & TOUCH ====================
        
        document.addEventListener('keydown', (e) => {
            if (e.key >= '1' && e.key <= '4') {
                const optionBtns = document.querySelectorAll(`#options-${currentSection} .option-btn:not(:disabled)`);
                const index = parseInt(e.key) - 1;
                if (optionBtns[index]) {
                    optionBtns[index].click();
                }
            }
            if (e.key === 'Enter') {
                const nextBtn = document.querySelector('.next-btn');
                if (nextBtn) nextBtn.click();
            }
        });
        
        // Touch swipe for reference card
        let touchStartY = 0;
        document.getElementById('referenceCard').addEventListener('touchstart', e => {
            touchStartY = e.changedTouches[0].screenY;
        }, { passive: true });
        
        document.getElementById('referenceCard').addEventListener('touchend', e => {
            const touchEndY = e.changedTouches[0].screenY;
            if (touchStartY - touchEndY > 50) {
                toggleReference();
            }
        }, { passive: true });
        
        // Initialize on load
        init();
    </script>
</body>
</html>
