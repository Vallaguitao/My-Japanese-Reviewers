<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N5 ãã†ã”ã† ã—ã‘ã‚“ - Comprehensive Assessment (Lessons 9-17)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Zen+Maru+Gothic:wght@400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans JP', 'Zen Maru Gothic', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: clamp(10px, 3vw, 20px);
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            text-align: center;
            color: white;
            margin-bottom: clamp(15px, 3vw, 30px);
        }
        
        .header .lesson-badge {
            display: inline-block;
            background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%);
            color: white;
            padding: 8px 24px;
            border-radius: 30px;
            font-size: clamp(12px, 1.8vw, 16px);
            font-weight: 600;
            margin-bottom: 12px;
            box-shadow: 0 4px 20px rgba(233, 69, 96, 0.4);
        }
        
        .header h1 {
            font-size: clamp(28px, 5vw, 48px);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #ffffff, #ffd1d9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: clamp(14px, 2.5vw, 20px);
            opacity: 0.9;
        }
        
        /* Score Board */
        .score-board {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: clamp(12px, 2vw, 20px);
            padding: clamp(15px, 2.5vw, 25px);
            margin-bottom: clamp(15px, 2vw, 20px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            border-top: 6px solid transparent;
            background-image: linear-gradient(white, white), linear-gradient(90deg, #e94560, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            background-origin: padding-box, border-box;
            background-clip: padding-box, border-box;
        }
        
        .score-item {
            text-align: center;
            min-width: 90px;
        }
        
        .score-label {
            font-size: clamp(11px, 1.5vw, 14px);
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .score-value {
            font-size: clamp(22px, 3.5vw, 32px);
            font-weight: 700;
            background: linear-gradient(135deg, #e94560, #0f3460);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .progress-bar {
            width: clamp(140px, 22vw, 220px);
            height: 14px;
            background: #e0e0e0;
            border-radius: 7px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e94560, #ff6b6b, #feca57);
            border-radius: 7px;
            transition: width 0.4s ease;
        }
        
        /* Section Tabs */
        .section-tabs {
            display: flex;
            gap: clamp(8px, 1.5vw, 12px);
            margin-bottom: clamp(15px, 2vw, 20px);
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tab-btn {
            padding: clamp(10px, 1.8vw, 14px) clamp(16px, 2.5vw, 28px);
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: clamp(12px, 1.8vw, 16px);
            font-weight: 600;
            transition: all 0.3s;
            background: rgba(255,255,255,0.25);
            color: white;
            white-space: nowrap;
            font-family: 'Noto Sans JP', sans-serif;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        
        .tab-btn:hover:not(.completed):not(.locked) {
            background: rgba(255,255,255,0.45);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.25);
        }
        
        .tab-btn.active {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            color: #e94560;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .tab-btn.completed {
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            color: white;
        }
        
        .tab-btn.completed::after {
            content: ' âœ“';
            font-weight: bold;
        }
        
        .tab-btn.locked {
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.4);
            cursor: not-allowed;
        }
        
        .tab-emoji {
            font-size: clamp(14px, 2vw, 18px);
        }
        
        /* Cards */
        .card {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: clamp(15px, 2.5vw, 25px);
            padding: clamp(20px, 4vw, 40px);
            margin-bottom: clamp(15px, 2vw, 20px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #e94560, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
        }
        
        .card-title {
            font-size: clamp(18px, 2.8vw, 26px);
            color: #0f3460;
            margin-bottom: clamp(15px, 2.5vw, 25px);
            padding-bottom: clamp(12px, 2vw, 18px);
            border-bottom: 3px solid #e94560;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .card-title .emoji {
            font-size: clamp(22px, 3vw, 30px);
        }
        
        /* Question Box */
        .question-box {
            background: linear-gradient(135deg, #f0f4ff 0%, #e8f4f8 100%);
            border-radius: clamp(12px, 2vw, 18px);
            padding: clamp(18px, 3vw, 30px);
            margin-bottom: clamp(15px, 2vw, 20px);
            border-left: clamp(4px, 0.6vw, 6px) solid #e94560;
        }
        
        .question-number {
            font-size: clamp(12px, 1.6vw, 15px);
            color: #e94560;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .question-text {
            font-size: clamp(14px, 2vw, 18px);
            color: #333;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .japanese-prompt {
            font-size: clamp(26px, 4.5vw, 40px);
            color: #0f3460;
            font-weight: 700;
            margin: clamp(15px, 2.5vw, 25px) 0;
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
            border-radius: 15px;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .english-prompt {
            font-size: clamp(20px, 3.2vw, 28px);
            color: #333;
            font-weight: 600;
            margin: clamp(15px, 2.5vw, 25px) 0;
            text-align: center;
        }
        
        /* Category Indicators */
        .category-indicator {
            display: inline-block;
            padding: clamp(6px, 1vw, 8px) clamp(12px, 1.8vw, 18px);
            border-radius: 25px;
            font-size: clamp(11px, 1.5vw, 14px);
            font-weight: 700;
            margin: 5px;
        }
        
        .category-indicator.vocab { background: linear-gradient(135deg, #e8f5e9, #c8e6c9); color: #2e7d32; }
        .category-indicator.grammar { background: linear-gradient(135deg, #e3f2fd, #bbdefb); color: #1565c0; }
        .category-indicator.listening { background: linear-gradient(135deg, #fff3e0, #ffe0b2); color: #e65100; }
        .category-indicator.reading { background: linear-gradient(135deg, #fce4ec, #f8bbd9); color: #c2185b; }
        .category-indicator.lesson { background: linear-gradient(135deg, #f3e5f5, #e1bee7); color: #7b1fa2; }
        
        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: clamp(10px, 1.8vw, 15px);
            margin-top: clamp(15px, 2.5vw, 25px);
        }
        
        @media (max-width: 550px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .option-btn {
            padding: clamp(14px, 2.5vw, 22px) clamp(12px, 2vw, 18px);
            border: 3px solid #e0e0e0;
            border-radius: clamp(10px, 1.8vw, 15px);
            background: white;
            cursor: pointer;
            font-size: clamp(17px, 2.8vw, 24px);
            transition: all 0.3s;
            text-align: center;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 500;
        }
        
        .option-btn:hover {
            border-color: #e94560;
            background: linear-gradient(135deg, #fff5f7 0%, #ffe8ec 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(233, 69, 96, 0.2);
        }
        
        .option-btn.correct {
            border-color: #4caf50;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            color: #2e7d32;
            animation: pulse 0.5s ease;
        }
        
        .option-btn.incorrect {
            border-color: #f44336;
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            color: #c62828;
            animation: shake 0.5s ease;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        
        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        
        /* Feedback */
        .feedback {
            padding: clamp(14px, 2.5vw, 20px);
            border-radius: clamp(10px, 1.8vw, 15px);
            margin-top: 20px;
            display: none;
            font-size: clamp(14px, 2vw, 17px);
            line-height: 1.6;
        }
        
        .feedback.correct {
            display: block;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left: 5px solid #4caf50;
            color: #2e7d32;
        }
        
        .feedback.incorrect {
            display: block;
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border-left: 5px solid #f44336;
            color: #c62828;
        }
        
        .feedback .correct-answer {
            font-size: clamp(18px, 2.8vw, 24px);
            font-weight: 700;
            margin-top: 12px;
        }
        
        .feedback .explanation {
            margin-top: 10px;
            font-size: clamp(13px, 1.8vw, 15px);
            opacity: 0.9;
            padding-top: 10px;
            border-top: 1px dashed currentColor;
        }
        
        .next-btn {
            padding: clamp(12px, 2vw, 16px) clamp(25px, 4vw, 40px);
            background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: clamp(15px, 2vw, 18px);
            font-weight: 700;
            cursor: pointer;
            margin-top: 18px;
            transition: all 0.3s;
            font-family: 'Noto Sans JP', sans-serif;
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
        }
        
        .next-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(233, 69, 96, 0.5);
        }
        
        /* Listening Section Special Styles */
        .audio-context {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            padding: clamp(18px, 3vw, 28px);
            border-radius: 15px;
            margin: 20px 0;
            border: 2px dashed #ff9800;
            text-align: center;
        }
        
        .audio-context .speaker-label {
            font-size: clamp(12px, 1.6vw, 15px);
            color: #e65100;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .audio-context .dialogue {
            font-size: clamp(18px, 3vw, 26px);
            color: #0f3460;
            font-weight: 600;
            margin: 10px 0;
            line-height: 1.8;
            white-space: pre-line; /* Allows newlines to render */
        }
        
        .audio-icon {
            font-size: clamp(30px, 5vw, 50px);
            margin-bottom: 15px;
            animation: soundwave 1.5s ease-in-out infinite;
        }
        
        @keyframes soundwave {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        /* Reading Section Special Styles */
        .reading-passage {
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
            padding: clamp(20px, 3.5vw, 35px);
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #e91e63;
            font-size: clamp(16px, 2.5vw, 22px);
            line-height: 2;
            color: #333;
        }
        
        .reading-passage .passage-title {
            font-size: clamp(14px, 1.8vw, 17px);
            color: #c2185b;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Results Screen */
        .practice-section {
            display: none;
        }
        
        .practice-section.active {
            display: block;
        }
        
        .results-card {
            text-align: center;
            padding: clamp(30px, 5vw, 50px) clamp(20px, 4vw, 40px);
        }
        
        .results-icon {
            font-size: clamp(60px, 12vw, 100px);
            margin-bottom: 20px;
        }
        
        .results-title {
            font-size: clamp(26px, 5vw, 40px);
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .results-title.pass {
            color: #4caf50;
        }
        
        .results-title.fail {
            color: #f44336;
        }
        
        .results-score {
            font-size: clamp(48px, 10vw, 80px);
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .results-score.pass {
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .results-score.fail {
            background: linear-gradient(135deg, #f44336, #ef5350);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .results-message {
            font-size: clamp(16px, 2.5vw, 22px);
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .results-breakdown {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: clamp(12px, 2vw, 20px);
            margin: 30px 0;
        }
        
        @media (max-width: 550px) {
            .results-breakdown {
                grid-template-columns: 1fr;
            }
        }
        
        .breakdown-item {
            background: linear-gradient(135deg, #f0f4ff 0%, #e8f4f8 100%);
            padding: clamp(15px, 2.5vw, 25px);
            border-radius: 15px;
            border-left: 4px solid #e94560;
        }
        
        .breakdown-item .emoji {
            font-size: clamp(24px, 4vw, 36px);
            margin-bottom: 8px;
        }
        
        .breakdown-label {
            font-size: clamp(13px, 1.8vw, 16px);
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .breakdown-value {
            font-size: clamp(22px, 3.5vw, 32px);
            font-weight: 700;
            background: linear-gradient(135deg, #e94560, #0f3460);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .breakdown-value.pass {
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .breakdown-value.fail {
            background: linear-gradient(135deg, #f44336, #ef5350);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .retry-btn {
            padding: clamp(14px, 2.5vw, 20px) clamp(35px, 6vw, 60px);
            background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: clamp(17px, 2.5vw, 22px);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Noto Sans JP', sans-serif;
            box-shadow: 0 8px 25px rgba(233, 69, 96, 0.4);
            margin: 10px;
        }
        
        .retry-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(233, 69, 96, 0.5);
        }
        
        /* Start Screen */
        .start-screen {
            text-align: center;
            padding: clamp(30px, 5vw, 50px) clamp(20px, 4vw, 40px);
        }
        
        .start-icon {
            font-size: clamp(60px, 12vw, 100px);
            margin-bottom: 25px;
        }
        
        .start-title {
            font-size: clamp(26px, 5vw, 40px);
            color: #0f3460;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .start-subtitle {
            font-size: clamp(15px, 2.2vw, 20px);
            color: #666;
            margin-bottom: 30px;
            line-height: 1.7;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(clamp(100px, 15vw, 140px), 1fr));
            gap: clamp(12px, 2vw, 20px);
            margin: 30px 0;
        }
        
        .info-box {
            background: linear-gradient(135deg, #f0f4ff 0%, #e8f4f8 100%);
            padding: clamp(15px, 2.5vw, 25px);
            border-radius: 15px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .info-box:hover {
            border-color: #e94560;
            transform: translateY(-3px);
        }
        
        .info-box .emoji {
            font-size: clamp(28px, 5vw, 40px);
            margin-bottom: 10px;
        }
        
        .info-box .label {
            font-size: clamp(11px, 1.5vw, 14px);
            color: #666;
            margin-bottom: 5px;
        }
        
        .info-box .value {
            font-size: clamp(16px, 2.5vw, 22px);
            font-weight: 700;
            color: #0f3460;
        }
        
        .start-btn {
            padding: clamp(16px, 3vw, 24px) clamp(45px, 8vw, 80px);
            background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: clamp(18px, 3vw, 26px);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Noto Sans JP', sans-serif;
            box-shadow: 0 10px 35px rgba(233, 69, 96, 0.4);
            margin-top: 20px;
        }
        
        .start-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 45px rgba(233, 69, 96, 0.5);
        }
        
        /* Notes Section */
        .notes-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: clamp(15px, 2.5vw, 25px);
            padding: clamp(20px, 4vw, 35px);
            margin-top: clamp(20px, 3vw, 30px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            border-left: 6px solid #ffc107;
        }
        
        .notes-title {
            font-size: clamp(18px, 2.8vw, 24px);
            color: #0f3460;
            font-weight: 700;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notes-content {
            font-size: clamp(13px, 1.8vw, 16px);
            color: #444;
            line-height: 1.9;
        }
        
        .notes-content ul {
            list-style: none;
            padding-left: 0;
        }
        
        .notes-content li {
            padding: 10px 0;
            border-bottom: 1px dashed #e0e0e0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .notes-content li:last-child {
            border-bottom: none;
        }
        
        /* Reference Toggle */
        .reference-toggle {
            text-align: center;
            margin-top: clamp(20px, 3vw, 30px);
        }
        
        .reference-btn {
            padding: clamp(12px, 2vw, 16px) clamp(25px, 4vw, 40px);
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            border-radius: 30px;
            font-size: clamp(14px, 2vw, 18px);
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 600;
        }
        
        .reference-btn:hover {
            background: rgba(255,255,255,0.35);
            transform: translateY(-2px);
        }
        
        .reference-card {
            display: none;
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: clamp(15px, 2.5vw, 25px);
            padding: clamp(20px, 4vw, 35px);
            margin-top: clamp(15px, 2vw, 25px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
        }
        
        .reference-card.show {
            display: block;
        }
        
        .ref-section {
            margin-bottom: clamp(20px, 3vw, 30px);
        }
        
        .ref-section-title {
            font-size: clamp(16px, 2.2vw, 20px);
            color: #e94560;
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e94560;
        }
        
        .ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(clamp(100px, 14vw, 140px), 1fr));
            gap: clamp(8px, 1.2vw, 12px);
        }
        
        .ref-item {
            background: linear-gradient(135deg, #ffe8ec, #ffd4dc);
            padding: clamp(10px, 1.5vw, 15px);
            border-radius: 12px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .ref-item:hover {
            border-color: #e94560;
            transform: translateY(-2px);
        }
        
        .ref-jp {
            font-size: clamp(16px, 2.2vw, 22px);
            color: #0f3460;
            font-weight: 700;
            margin-bottom: 5px;
            display: block;
        }
        
        .ref-en {
            font-size: clamp(11px, 1.4vw, 13px);
            color: #666;
            display: block;
        }
        
        /* Large Desktop (1920x1080) */
        @media (min-width: 1400px) {
            .container {
                max-width: 1300px;
            }
            
            .card {
                padding: 50px;
            }
        }
        
        /* Hidden utility */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="lesson-badge">ã ã„ 9-17 ã‹</div>
            <h1>ğŸ“ N5 ãã†ã”ã† ã—ã‘ã‚“</h1>
            <p>Comprehensive Assessment Quiz (Lessons 9-17)</p>
        </div>
        
        <div class="score-board hidden" id="scoreBoard">
            <div class="score-item">
                <div class="score-label">ã¦ã‚“ã™ã†</div>
                <div class="score-value" id="score">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">ã—ã‚“ã¡ã‚‡ã</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress" style="width: 0%"></div>
                </div>
            </div>
            <div class="score-item">
                <div class="score-label">ã‚‚ã‚“ã ã„</div>
                <div class="score-value"><span id="answered">0</span>/<span id="total">40</span></div>
            </div>
        </div>
        
        <div class="section-tabs hidden" id="sectionTabs">
            <button class="tab-btn active" id="tab-vocab" onclick="switchSection('vocab')">
                <span class="tab-emoji">ğŸ“š</span>ã”ã„
            </button>
            <button class="tab-btn locked" id="tab-grammar" onclick="switchSection('grammar')">
                <span class="tab-emoji">ğŸ“–</span>ã¶ã‚“ã½ã†
            </button>
            <button class="tab-btn locked" id="tab-listening" onclick="switchSection('listening')">
                <span class="tab-emoji">ğŸ§</span>ã¡ã‚‡ã†ã‹ã„
            </button>
            <button class="tab-btn locked" id="tab-reading" onclick="switchSection('reading')">
                <span class="tab-emoji">ğŸ“„</span>ã©ã£ã‹ã„
            </button>
        </div>
        
        <div class="card" id="startScreen">
            <div class="start-screen">
                <div class="start-icon">ğŸ¯</div>
                <h2 class="start-title">N5 ãã†ã”ã† ã—ã‘ã‚“</h2>
                <p class="start-subtitle">
                    ã ã„9ã‹ã‹ã‚‰ ã ã„17ã‹ã¾ã§ã® ã«ã»ã‚“ã”ã‚’ ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼<br>
                    Test your Japanese from Lessons 9-17!
                </p>
                
                <div class="info-grid">
                    <div class="info-box">
                        <div class="emoji">ğŸ“Š</div>
                        <div class="label">ã‚‚ã‚“ã ã„ã™ã†</div>
                        <div class="value">40 ã‚‚ã‚“</div>
                    </div>
                    <div class="info-box">
                        <div class="emoji">ğŸ¯</div>
                        <div class="label">ã”ã†ã‹ãã¦ã‚“</div>
                        <div class="value">80%</div>
                    </div>
                    <div class="info-box">
                        <div class="emoji">ğŸ”€</div>
                        <div class="label">ã‚‚ã‚“ã ã„</div>
                        <div class="value">ãƒ©ãƒ³ãƒ€ãƒ </div>
                    </div>
                    <div class="info-box">
                        <div class="emoji">ğŸ“</div>
                        <div class="label">ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div>
                        <div class="value">4 ã¶ã¶ã‚“</div>
                    </div>
                </div>
                
                <button class="start-btn" onclick="startQuiz()">
                    ã¯ã˜ã‚ã‚‹ ğŸš€
                </button>
            </div>
        </div>
        
        <div class="practice-section" id="vocab-section">
            <div class="card">
                <div class="card-title">
                    <span class="emoji">ğŸ“š</span>
                    ã‚»ã‚¯ã‚·ãƒ§ãƒ³1: ã”ã„ (Vocabulary)
                </div>
                <div id="vocab-question"></div>
            </div>
        </div>
        
        <div class="practice-section" id="grammar-section">
            <div class="card">
                <div class="card-title">
                    <span class="emoji">ğŸ“–</span>
                    ã‚»ã‚¯ã‚·ãƒ§ãƒ³2: ã¶ã‚“ã½ã† (Grammar)
                </div>
                <div id="grammar-question"></div>
            </div>
        </div>
        
        <div class="practice-section" id="listening-section">
            <div class="card">
                <div class="card-title">
                    <span class="emoji">ğŸ§</span>
                    ã‚»ã‚¯ã‚·ãƒ§ãƒ³3: ã¡ã‚‡ã†ã‹ã„ (Listening)
                </div>
                <div id="listening-question"></div>
            </div>
        </div>
        
        <div class="practice-section" id="reading-section">
            <div class="card">
                <div class="card-title">
                    <span class="emoji">ğŸ“„</span>
                    ã‚»ã‚¯ã‚·ãƒ§ãƒ³4: ã©ã£ã‹ã„ (Reading Comprehension)
                </div>
                <div id="reading-question"></div>
            </div>
        </div>
        
        <div class="practice-section" id="results-section">
            <div class="card results-card">
                <div class="results-icon" id="results-icon">ğŸ‰</div>
                <div class="results-title pass" id="results-title">ã”ã†ã‹ãï¼</div>
                <div class="results-score pass" id="final-score">100%</div>
                <div class="results-message" id="results-message">
                    ã™ã°ã‚‰ã—ã„ï¼ ã‚ãªãŸã¯ N5ãƒ¬ãƒ™ãƒ«ã® ã«ã»ã‚“ã”ã‚’ ã‚ˆã ã‚Šã‹ã„ã—ã¦ã„ã¾ã™ï¼
                </div>
                <div class="results-breakdown">
                    <div class="breakdown-item">
                        <div class="emoji">ğŸ“š</div>
                        <div class="breakdown-label">ã”ã„</div>
                        <div class="breakdown-value" id="vocab-score">0/10</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="emoji">ğŸ“–</div>
                        <div class="breakdown-label">ã¶ã‚“ã½ã†</div>
                        <div class="breakdown-value" id="grammar-score">0/10</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="emoji">ğŸ§</div>
                        <div class="breakdown-label">ã¡ã‚‡ã†ã‹ã„</div>
                        <div class="breakdown-value" id="listening-score">0/10</div>
                    </div>
                    <div class="breakdown-item">
                        <div class="emoji">ğŸ“„</div>
                        <div class="breakdown-label">ã©ã£ã‹ã„</div>
                        <div class="breakdown-value" id="reading-score">0/10</div>
                    </div>
                </div>
                <button class="retry-btn" onclick="restartQuiz()">ã‚‚ã†ã„ã¡ã© ğŸ”„</button>
            </div>
        </div>
        
        <div class="notes-card">
            <div class="notes-title">ğŸ“ ã¹ã‚“ãã‚‡ã†ã® ãƒã‚¤ãƒ³ãƒˆ</div>
            <div class="notes-content">
                <ul>
                    <li>
                        <span>ğŸ“š</span>
                        <span><strong>ã”ã„ (Vocabulary):</strong> ã ã„9-17ã‹ã® ãŸã‚“ã”ã€ã‚ã„ã—ã€ã©ã†ã—ã€ã‘ã„ã‚ˆã†ã—ã‚’ ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</span>
                    </li>
                    <li>
                        <span>ğŸ“–</span>
                        <span><strong>ã¶ã‚“ã½ã† (Grammar):</strong> ã€œãŸã„ã§ã™ã€ã€œã¦ã„ã¾ã™ã€ã€œã¦ã‚‚ã„ã„ã§ã™ã€ã€œãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€ã€œãŸã“ã¨ãŒã‚ã‚Šã¾ã™ ãªã©ã€‚</span>
                    </li>
                    <li>
                        <span>ğŸ§</span>
                        <span><strong>ã¡ã‚‡ã†ã‹ã„ (Listening):</strong> ã‹ã„ã‚ã‚’ ã‚ˆã‚“ã§ã€ã—ã¤ã‚‚ã‚“ã« ã“ãŸãˆã¦ãã ã•ã„ã€‚</span>
                    </li>
                    <li>
                        <span>ğŸ“„</span>
                        <span><strong>ã©ã£ã‹ã„ (Reading):</strong> ã¿ã˜ã‹ã„ ã¶ã‚“ã—ã‚‡ã†ã‚’ ã‚ˆã‚“ã§ã€ãªã„ã‚ˆã†ã‚’ ã‚Šã‹ã„ã—ã¦ãã ã•ã„ã€‚</span>
                    </li>
                    <li>
                        <span>ğŸ¯</span>
                        <span><strong>ã”ã†ã‹ãã¦ã‚“:</strong> 80%ã„ã˜ã‚‡ã†ã§ ã”ã†ã‹ãã§ã™ï¼ ãŒã‚“ã°ã‚Šã¾ã—ã‚‡ã†ï¼</span>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="reference-toggle">
            <button class="reference-btn" onclick="toggleReference()">ğŸ“– ã•ã‚“ã“ã†ãƒªã‚¹ãƒˆã‚’ ã¿ã‚‹</button>
        </div>
        
        <div class="reference-card" id="referenceCard">
            <div class="ref-section">
                <div class="ref-section-title">ğŸ“š ã ã„9-12ã‹ ã”ã„</div>
                <div class="ref-grid">
                    <div class="ref-item"><span class="ref-jp">ã‚ã‹ã‚Šã¾ã™</span><span class="ref-en">understand</span></div>
                    <div class="ref-item"><span class="ref-jp">ã‚ã‚Šã¾ã™</span><span class="ref-en">have</span></div>
                    <div class="ref-item"><span class="ref-jp">ã™ã</span><span class="ref-en">like</span></div>
                    <div class="ref-item"><span class="ref-jp">ãã‚‰ã„</span><span class="ref-en">dislike</span></div>
                    <div class="ref-item"><span class="ref-jp">ã˜ã‚‡ã†ãš</span><span class="ref-en">skillful</span></div>
                    <div class="ref-item"><span class="ref-jp">ã¸ãŸ</span><span class="ref-en">poor at</span></div>
                    <div class="ref-item"><span class="ref-jp">ãŠãŠã„</span><span class="ref-en">many</span></div>
                    <div class="ref-item"><span class="ref-jp">ã™ããªã„</span><span class="ref-en">few</span></div>
                    <div class="ref-item"><span class="ref-jp">ã‚ãŸã‚‰ã—ã„</span><span class="ref-en">new</span></div>
                    <div class="ref-item"><span class="ref-jp">ãµã‚‹ã„</span><span class="ref-en">old</span></div>
                    <div class="ref-item"><span class="ref-jp">ã„ããŒã—ã„</span><span class="ref-en">busy</span></div>
                    <div class="ref-item"><span class="ref-jp">ãŸã®ã—ã„</span><span class="ref-en">fun</span></div>
                </div>
            </div>
            <div class="ref-section">
                <div class="ref-section-title">ğŸ“š ã ã„13-17ã‹ ã”ã„</div>
                <div class="ref-grid">
                    <div class="ref-item"><span class="ref-jp">ã»ã—ã„</span><span class="ref-en">want</span></div>
                    <div class="ref-item"><span class="ref-jp">ãŠã‚ˆãã¾ã™</span><span class="ref-en">swim</span></div>
                    <div class="ref-item"><span class="ref-jp">ã‚ãã³ã¾ã™</span><span class="ref-en">play</span></div>
                    <div class="ref-item"><span class="ref-jp">ãªã‚‰ã„ã¾ã™</span><span class="ref-en">learn</span></div>
                    <div class="ref-item"><span class="ref-jp">ã®ã‚Šã¾ã™</span><span class="ref-en">ride</span></div>
                    <div class="ref-item"><span class="ref-jp">ãŠã‚Šã¾ã™</span><span class="ref-en">get off</span></div>
                    <div class="ref-item"><span class="ref-jp">ã®ã‚Šã‹ãˆã¾ã™</span><span class="ref-en">transfer</span></div>
                    <div class="ref-item"><span class="ref-jp">ã‚ã³ã¾ã™</span><span class="ref-en">take shower</span></div>
                    <div class="ref-item"><span class="ref-jp">ã„ã‚Œã¾ã™</span><span class="ref-en">put in</span></div>
                    <div class="ref-item"><span class="ref-jp">ã ã—ã¾ã™</span><span class="ref-en">take out</span></div>
                    <div class="ref-item"><span class="ref-jp">ã‚ã™ã‚Œã¾ã™</span><span class="ref-en">forget</span></div>
                    <div class="ref-item"><span class="ref-jp">ãŠã¼ãˆã¾ã™</span><span class="ref-en">memorize</span></div>
                </div>
            </div>
            <div class="ref-section">
                <div class="ref-section-title">ğŸ“– ã¶ã‚“ã½ã† ãƒã‚¤ãƒ³ãƒˆ</div>
                <div class="ref-grid">
                    <div class="ref-item"><span class="ref-jp">ã€œãŒã™ãã§ã™</span><span class="ref-en">like ~</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œãŒã»ã—ã„ã§ã™</span><span class="ref-en">want ~</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œãŸã„ã§ã™</span><span class="ref-en">want to ~</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œã¦ã„ã¾ã™</span><span class="ref-en">is doing</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œã¦ã‚‚ã„ã„ã§ã™</span><span class="ref-en">may ~</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œã¦ã¯ã„ã‘ã¾ã›ã‚“</span><span class="ref-en">must not</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“</span><span class="ref-en">must</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œãªã„ã§ãã ã•ã„</span><span class="ref-en">please don't</span></div>
                    <div class="ref-item"><span class="ref-jp">ã€œãŸã“ã¨ãŒã‚ã‚Šã¾ã™</span><span class="ref-en">have done</span></div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ===== COMPREHENSIVE QUESTION DATA (Lessons 9-17) =====
        
        // Vocabulary Data L9-17
        const vocabularyData = [
            // L9 - Adjectives & Preferences
            { jp: 'ã‚ã‹ã‚Šã¾ã™', en: 'understand', lesson: 9, category: 'verb' },
            { jp: 'ã‚ã‚Šã¾ã™', en: 'have, possess', lesson: 9, category: 'verb' },
            { jp: 'ã™ã', en: 'like', lesson: 9, category: 'adj' },
            { jp: 'ãã‚‰ã„', en: 'dislike', lesson: 9, category: 'adj' },
            { jp: 'ã˜ã‚‡ã†ãš', en: 'good at, skillful', lesson: 9, category: 'adj' },
            { jp: 'ã¸ãŸ', en: 'poor at, unskillful', lesson: 9, category: 'adj' },
            { jp: 'ã‚Šã‚‡ã†ã‚Š', en: 'cooking, cuisine', lesson: 9, category: 'noun' },
            { jp: 'ã®ã¿ã‚‚ã®', en: 'beverage, drink', lesson: 9, category: 'noun' },
            { jp: 'ã‚¹ãƒãƒ¼ãƒ„', en: 'sports', lesson: 9, category: 'noun' },
            { jp: 'ãŠã‚“ãŒã', en: 'music', lesson: 9, category: 'noun' },
            { jp: 'ã‚«ãƒ©ã‚ªã‚±', en: 'karaoke', lesson: 9, category: 'noun' },
            // L10 - Location & Existence
            { jp: 'ã„ã¾ã™', en: 'exist (animate)', lesson: 10, category: 'verb' },
            { jp: 'ã‚ã‚Šã¾ã™', en: 'exist (inanimate)', lesson: 10, category: 'verb' },
            { jp: 'ã„ã‚ã„ã‚', en: 'various', lesson: 10, category: 'adj' },
            { jp: 'ãŠã¨ã“ã®ã²ã¨', en: 'man', lesson: 10, category: 'noun' },
            { jp: 'ãŠã‚“ãªã®ã²ã¨', en: 'woman', lesson: 10, category: 'noun' },
            { jp: 'ã„ã¬', en: 'dog', lesson: 10, category: 'noun' },
            { jp: 'ã­ã“', en: 'cat', lesson: 10, category: 'noun' },
            { jp: 'ã‚‚ã®', en: 'thing', lesson: 10, category: 'noun' },
            // L11 - Counting & Family
            { jp: 'ã„ãã¤', en: 'how many', lesson: 11, category: 'counter' },
            { jp: 'ã²ã¨ã¤', en: 'one (thing)', lesson: 11, category: 'counter' },
            { jp: 'ãµãŸã¤', en: 'two (things)', lesson: 11, category: 'counter' },
            { jp: 'ã‹ãã', en: 'family', lesson: 11, category: 'noun' },
            { jp: 'ãã‚‡ã†ã ã„', en: 'siblings', lesson: 11, category: 'noun' },
            // L12 - Adjectives
            { jp: 'ã‹ã‚“ãŸã‚“', en: 'simple, easy', lesson: 12, category: 'adj' },
            { jp: 'ã¡ã‹ã„', en: 'near', lesson: 12, category: 'adj' },
            { jp: 'ã¨ãŠã„', en: 'far', lesson: 12, category: 'adj' },
            { jp: 'ã¯ã‚„ã„', en: 'fast, early', lesson: 12, category: 'adj' },
            { jp: 'ãŠãã„', en: 'slow, late', lesson: 12, category: 'adj' },
            { jp: 'ã‚ãŸãŸã‹ã„', en: 'warm', lesson: 12, category: 'adj' },
            { jp: 'ã™ãšã—ã„', en: 'cool', lesson: 12, category: 'adj' },
            // L13 - Desires
            { jp: 'ã»ã—ã„', en: 'want (thing)', lesson: 13, category: 'adj' },
            { jp: 'ãŠã‚ˆãã¾ã™', en: 'swim', lesson: 13, category: 'verb' },
            { jp: 'ã‚ãã³ã¾ã™', en: 'play, enjoy', lesson: 13, category: 'verb' },
            { jp: 'ã¤ã‹ã‚Œã¾ã™', en: 'get tired', lesson: 13, category: 'verb' },
            { jp: 'ã•ã‚“ã½ã—ã¾ã™', en: 'take a walk', lesson: 13, category: 'verb' },
            // L14 - Te-form verbs
            { jp: 'ã¤ã‘ã¾ã™', en: 'turn on', lesson: 14, category: 'verb' },
            { jp: 'ã‘ã—ã¾ã™', en: 'turn off', lesson: 14, category: 'verb' },
            { jp: 'ã‚ã‘ã¾ã™', en: 'open', lesson: 14, category: 'verb' },
            { jp: 'ã—ã‚ã¾ã™', en: 'close', lesson: 14, category: 'verb' },
            { jp: 'ã¾ã¡ã¾ã™', en: 'wait', lesson: 14, category: 'verb' },
            { jp: 'ã‚‚ã¡ã¾ã™', en: 'hold, have', lesson: 14, category: 'verb' },
            { jp: 'ã¦ã¤ã ã„ã¾ã™', en: 'help', lesson: 14, category: 'verb' },
            // L15 - Permission & Prohibition
            { jp: 'ãŸã¡ã¾ã™', en: 'stand', lesson: 15, category: 'verb' },
            { jp: 'ã™ã‚ã‚Šã¾ã™', en: 'sit', lesson: 15, category: 'verb' },
            { jp: 'ã¤ã‹ã„ã¾ã™', en: 'use', lesson: 15, category: 'verb' },
            { jp: 'ã™ã¿ã¾ã™', en: 'live, reside', lesson: 15, category: 'verb' },
            // L16 - Sequence & Connection
            { jp: 'ã®ã‚Šã¾ã™', en: 'ride, get on', lesson: 16, category: 'verb' },
            { jp: 'ãŠã‚Šã¾ã™', en: 'get off', lesson: 16, category: 'verb' },
            { jp: 'ã®ã‚Šã‹ãˆã¾ã™', en: 'transfer', lesson: 16, category: 'verb' },
            { jp: 'ã‚ã³ã¾ã™', en: 'take (shower)', lesson: 16, category: 'verb' },
            { jp: 'ã‹ã‚‰ã ', en: 'body', lesson: 16, category: 'noun' },
            // L17 - Negative requests & Health
            { jp: 'ãŠã¼ãˆã¾ã™', en: 'memorize', lesson: 17, category: 'verb' },
            { jp: 'ã‚ã™ã‚Œã¾ã™', en: 'forget', lesson: 17, category: 'verb' },
            { jp: 'ã¯ãªãã—ã¾ã™', en: 'pay', lesson: 17, category: 'verb' },
            { jp: 'ã—ã‚“ã±ã„ã—ã¾ã™', en: 'worry', lesson: 17, category: 'verb' },
            { jp: 'ã–ã‚“ãã‚‡ã†ã—ã¾ã™', en: 'work overtime', lesson: 17, category: 'verb' },
            { jp: 'ãã™ã‚Š', en: 'medicine', lesson: 17, category: 'noun' },
            { jp: 'ã­ã¤', en: 'fever', lesson: 17, category: 'noun' },
            { jp: 'ã³ã‚‡ã†ã', en: 'illness', lesson: 17, category: 'noun' }
        ];
        
        // Grammar Questions (Lessons 9-17)
        const grammarQuestions = [
            { sentence: 'ã‚ãŸã—ã¯ ãŠã‚“ãŒããŒ ___ã§ã™ã€‚', answer: 'ã™ã', options: ['ã™ã', 'ã™ããª', 'ã™ãã«', 'ã™ãã®'], lesson: 9, explanation: 'ã€œãŒã™ãã§ã™ = like ~ (Adjective for preferences)' },
            { sentence: 'ã‚„ã¾ã ã•ã‚“ã¯ ãƒ†ãƒ‹ã‚¹ãŒ ___ã§ã™ã€‚', answer: 'ã˜ã‚‡ã†ãš', options: ['ã˜ã‚‡ã†ãš', 'ã˜ã‚‡ã†ãšãª', 'ã˜ã‚‡ã†ãšã«', 'ã¸ãŸ'], lesson: 9, explanation: 'ã€œãŒã˜ã‚‡ã†ãšã§ã™ = good at ~ (Adjective for skill)' },
            { sentence: 'ã¸ã‚„ã« ã¤ããˆãŒ ___ã€‚', answer: 'ã‚ã‚Šã¾ã™', options: ['ã‚ã‚Šã¾ã™', 'ã„ã¾ã™', 'ã§ã™', 'ã¾ã™'], lesson: 10, explanation: 'ã‚ã‚Šã¾ã™ is used for inanimate objects existence.' },
            { sentence: 'ã“ã†ãˆã‚“ã« ã“ã©ã‚‚ãŒ ___ã€‚', answer: 'ã„ã¾ã™', options: ['ã„ã¾ã™', 'ã‚ã‚Šã¾ã™', 'ã§ã™', 'ã¾ã™'], lesson: 10, explanation: 'ã„ã¾ã™ is used for animate beings (people/animals) existence.' },
            { sentence: 'ã‚Šã‚“ã”ã‚’ ___ãã ã•ã„ã€‚', answer: 'ã¿ã£ã¤', options: ['ã¿ã£ã¤', 'ã•ã‚“ã¤', 'ã¿ã¤', 'ã•ã‚“'], lesson: 11, explanation: 'Japanese counters: ã²ã¨ã¤ã€ãµãŸã¤ã€ã¿ã£ã¤...' },
            { sentence: 'ã¨ã†ãã‚‡ã†ã¯ ãŠãŠã•ã‹ã‚ˆã‚Š ___ã§ã™ã€‚', answer: 'ãŠãŠãã„', options: ['ãŠãŠãã„', 'ãŠãŠãã', 'ãŠãŠãã„ã®', 'ãŠãŠãã„ãª'], lesson: 12, explanation: 'Aã¯Bã‚ˆã‚Šã€œã§ã™ = A is more ~ than B.' },
            { sentence: 'ã‚ãŸã—ã¯ ã‚ãŸã‚‰ã—ã„ ãã‚‹ã¾ãŒ ___ã§ã™ã€‚', answer: 'ã»ã—ã„', options: ['ã»ã—ã„', 'ã»ã—ã„ãª', 'ãŸã„ã§ã™', 'ãŸã„'], lesson: 13, explanation: 'ã€œãŒã»ã—ã„ã§ã™ = want ~ (used for nouns).' },
            { sentence: 'ã«ã»ã‚“ã¸ ã„ã___ã§ã™ã€‚', answer: 'ãŸã„', options: ['ãŸã„', 'ãŸã„ã§ã™', 'ã»ã—ã„', 'ã¾ã™'], lesson: 13, explanation: 'V-ã¾ã™ stem + ãŸã„ã§ã™ = want to do (used for actions).' },
            { sentence: 'ã™ã¿ã¾ã›ã‚“ã€ã—ãŠã‚’ ___ãã ã•ã„ã€‚', answer: 'ã¨ã£ã¦', options: ['ã¨ã£ã¦', 'ã¨ã‚Š', 'ã¨ã‚‹', 'ã¨ã£ãŸ'], lesson: 14, explanation: 'ã€œã¦ãã ã•ã„ = please do ~ (Te-form request).' },
            { sentence: 'ã„ã¾ ã”ã¯ã‚“ã‚’ ___ã„ã¾ã™ã€‚', answer: 'ãŸã¹ã¦', options: ['ãŸã¹ã¦', 'ãŸã¹', 'ãŸã¹ã‚‹', 'ãŸã¹ãŸ'], lesson: 14, explanation: 'ã€œã¦ã„ã¾ã™ = is doing ~ (Ongoing action).' },
            { sentence: 'ã“ã“ã§ ã—ã‚ƒã—ã‚“ã‚’ ã¨ã£ã¦ã‚‚ ___ã‹ã€‚', answer: 'ã„ã„ã§ã™', options: ['ã„ã„ã§ã™', 'ã ã‚ã§ã™', 'ã„ã¾ã™', 'ã‚ã‚Šã¾ã™'], lesson: 15, explanation: 'ã€œã¦ã‚‚ã„ã„ã§ã™ã‹ = May I ~? (Asking permission).' },
            { sentence: 'ã“ã“ã§ ã‚¿ãƒã‚³ã‚’ ã™ã£ã¦ã¯ ___ã€‚', answer: 'ã„ã‘ã¾ã›ã‚“', options: ['ã„ã‘ã¾ã›ã‚“', 'ã„ã„ã§ã™', 'ãã ã•ã„', 'ã¾ã™'], lesson: 15, explanation: 'ã€œã¦ã¯ã„ã‘ã¾ã›ã‚“ = must not ~ (Prohibition).' },
            { sentence: 'ãã™ã‚Šã‚’ ã®ã¾___ãªã‚Šã¾ã›ã‚“ã€‚', answer: 'ãªã‘ã‚Œã°', options: ['ãªã‘ã‚Œã°', 'ãªãã¦', 'ãªã„ã§', 'ãªãã¦ã¯'], lesson: 17, explanation: 'ã€œãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ = must ~ (Obligation).' },
            { sentence: 'ã“ã“ã« ãã‚‹ã¾ã‚’ ___ãã ã•ã„ã€‚', answer: 'ã¨ã‚ãªã„ã§', options: ['ã¨ã‚ãªã„ã§', 'ã¨ã‚ãªãã¦', 'ã¨ã‚ã¾ã›ã‚“', 'ã¨ã‚ãªã„'], lesson: 17, explanation: 'ã€œãªã„ã§ãã ã•ã„ = please don\'t ~ (Negative request).' },
            { sentence: 'ã§ã‚“ã—ã‚ƒã‚’ ã®ã‚Š___ã€ãƒã‚¹ã« ã®ã‚Šã¾ã™ã€‚', answer: 'ã‹ãˆã¦', options: ['ã‹ãˆã¦', 'ã‹ãˆã¾ã™', 'ã‹ãˆã£ã¦', 'ã‹ã‚ã£ã¦'], lesson: 16, explanation: 'V-ã¦ form connects sequential actions.' },
            { sentence: 'ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’ ___ã‹ã‚‰ã€ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã™ã€‚', answer: 'ã‚ã³ã¦', options: ['ã‚ã³ã¦', 'ã‚ã³ã£ã¦', 'ã‚ã³ã¾ã™', 'ã‚ã³ãŸ'], lesson: 16, explanation: 'V-ã¦ã‹ã‚‰ = after doing V.' }
        ];
        
        // Listening Questions (Dialogue-based) L9-17
        const listeningQuestions = [
            {
                context: 'ğŸ§ A: ã™ãšãã•ã‚“ã¯ ã‚Šã‚‡ã†ã‚ŠãŒ ã˜ã‚‡ã†ãšã§ã™ã­ã€‚\nB: ã„ã„ãˆã€ã¾ã ã¾ã ã§ã™ã€‚ã§ã‚‚ã€ã‚Šã‚‡ã†ã‚ŠãŒ ã ã„ã™ãã§ã™ã€‚',
                question: 'ã™ãšãã•ã‚“ã¯ ã‚Šã‚‡ã†ã‚ŠãŒ ã™ãã§ã™ã‹ã€‚',
                answer: 'ã¯ã„ã€ã ã„ã™ãã§ã™',
                options: ['ã¯ã„ã€ã ã„ã™ãã§ã™', 'ã„ã„ãˆã€ãã‚‰ã„ã§ã™', 'ã‚ã‹ã‚Šã¾ã›ã‚“', 'ã¾ã‚ã¾ã‚ã§ã™'],
                explanation: 'B says "ã‚Šã‚‡ã†ã‚ŠãŒ ã ã„ã™ãã§ã™" (I love cooking).'
            },
            {
                context: 'ğŸ§ A: ã“ã® ã¸ã‚„ã« ãªã«ãŒ ã‚ã‚Šã¾ã™ã‹ã€‚\nB: ã¤ããˆã¨ ã„ã™ã¨ ã»ã‚“ã ãªãŒ ã‚ã‚Šã¾ã™ã€‚',
                question: 'ã¸ã‚„ã« ãªã«ãŒ ã‚ã‚Šã¾ã™ã‹ã€‚',
                answer: 'ã¤ããˆã¨ ã„ã™ã¨ ã»ã‚“ã ãª',
                options: ['ã¤ããˆã¨ ã„ã™ã¨ ã»ã‚“ã ãª', 'ãƒ™ãƒƒãƒ‰ã¨ ã¤ããˆ', 'ãƒ†ãƒ¬ãƒ“ã¨ ã‚½ãƒ•ã‚¡ãƒ¼', 'ãªã«ã‚‚ ã‚ã‚Šã¾ã›ã‚“'],
                explanation: 'B lists desk, chair, and bookshelf.'
            },
            {
                context: 'ğŸ§ A: ã”ã‹ããã¯ ãªã‚“ã«ã‚“ã§ã™ã‹ã€‚\nB: ã‚ˆã«ã‚“ã§ã™ã€‚ã¡ã¡ã¨ ã¯ã¯ã¨ ã‚ã«ã¨ ã‚ãŸã—ã§ã™ã€‚',
                question: 'Bã•ã‚“ã«ã¯ ãã‚‡ã†ã ã„ãŒ ã„ã¾ã™ã‹ã€‚',
                answer: 'ã¯ã„ã€ã‚ã«ãŒ ã„ã¾ã™',
                options: ['ã¯ã„ã€ã‚ã«ãŒ ã„ã¾ã™', 'ã„ã„ãˆã€ã„ã¾ã›ã‚“', 'ã¯ã„ã€ã„ã‚‚ã†ã¨ãŒ ã„ã¾ã™', 'ã¯ã„ã€ãŠã¨ã†ã¨ãŒ ã„ã¾ã™'],
                explanation: 'B mentions "ã‚ã«" (older brother).'
            },
            {
                context: 'ğŸ§ A: ã¨ã†ãã‚‡ã†ã¨ ãŠãŠã•ã‹ã¨ ã©ã¡ã‚‰ãŒ ãŠãŠãã„ã§ã™ã‹ã€‚\nB: ã¨ã†ãã‚‡ã†ã® ã»ã†ãŒ ãŠãŠãã„ã§ã™ã€‚',
                question: 'ã©ã¡ã‚‰ãŒ ãŠãŠãã„ã§ã™ã‹ã€‚',
                answer: 'ã¨ã†ãã‚‡ã†',
                options: ['ã¨ã†ãã‚‡ã†', 'ãŠãŠã•ã‹', 'ãŠãªã˜ã§ã™', 'ã‚ã‹ã‚Šã¾ã›ã‚“'],
                explanation: 'B says "ã¨ã†ãã‚‡ã†ã® ã»ã†ãŒ ãŠãŠãã„ã§ã™" (Tokyo is bigger).'
            },
            {
                context: 'ğŸ§ A: ãŸã‚“ã˜ã‚‡ã†ã³ã« ãªã«ãŒ ã»ã—ã„ã§ã™ã‹ã€‚\nB: ã‚ãŸã‚‰ã—ã„ ã‚«ãƒ¡ãƒ©ãŒ ã»ã—ã„ã§ã™ã€‚',
                question: 'Bã•ã‚“ã¯ ãªã«ãŒ ã»ã—ã„ã§ã™ã‹ã€‚',
                answer: 'ã‚«ãƒ¡ãƒ©',
                options: ['ã‚«ãƒ¡ãƒ©', 'ãã‚‹ã¾', 'ã§ã‚“ã‚', 'ã¨ã‘ã„'],
                explanation: 'B says "ã‚«ãƒ¡ãƒ©ãŒ ã»ã—ã„ã§ã™" (want a camera).'
            },
            {
                context: 'ğŸ§ A: ã™ã¿ã¾ã›ã‚“ã€ã¾ã©ã‚’ ã‚ã‘ã¦ã‚‚ ã„ã„ã§ã™ã‹ã€‚\nB: ãˆãˆã€ã©ã†ãã€‚',
                question: 'Aã•ã‚“ã¯ ãªã«ã‚’ ã—ãŸã„ã§ã™ã‹ã€‚',
                answer: 'ã¾ã©ã‚’ ã‚ã‘ãŸã„',
                options: ['ã¾ã©ã‚’ ã‚ã‘ãŸã„', 'ã¾ã©ã‚’ ã—ã‚ãŸã„', 'ã§ã‚“ãã‚’ ã¤ã‘ãŸã„', 'ã§ã‚“ãã‚’ ã‘ã—ãŸã„'],
                explanation: 'A asks permission to open the window.'
            },
            {
                context: 'ğŸ§ A: ã¾ã„ã‚ã• ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚\nB: ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’ ã‚ã³ã¦ã€ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¦ã€ã‹ã„ã—ã‚ƒã¸ ã„ãã¾ã™ã€‚',
                question: 'Bã•ã‚“ã¯ ã‚ã• ã¾ãš ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚',
                answer: 'ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’ ã‚ã³ã¾ã™',
                options: ['ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’ ã‚ã³ã¾ã™', 'ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã™', 'ã‹ã„ã—ã‚ƒã¸ ã„ãã¾ã™', 'ãŠãã¾ã™'],
                explanation: 'The first action in the sequence is showering.'
            },
            {
                context: 'ğŸ§ A: ãã™ã‚Šã¯ ã®ã¿ã¾ã—ãŸã‹ã€‚\nB: ã„ã„ãˆã€ã¾ã ã§ã™ã€‚\nA: ã¯ã‚„ã ã®ã¾ãªã‘ã‚Œã° ãªã‚Šã¾ã›ã‚“ã‚ˆã€‚',
                question: 'Bã•ã‚“ã¯ ãã™ã‚Šã‚’ ã®ã¿ã¾ã—ãŸã‹ã€‚',
                answer: 'ã„ã„ãˆã€ã¾ã ã§ã™',
                options: ['ã„ã„ãˆã€ã¾ã ã§ã™', 'ã¯ã„ã€ã®ã¿ã¾ã—ãŸ', 'ã„ã„ãˆã€ã®ã¿ã¾ã›ã‚“', 'ã®ã¿ãŸããªã„ã§ã™'],
                explanation: 'B replies "ã„ã„ãˆã€ã¾ã ã§ã™" (No, not yet).'
            },
            {
                context: 'ğŸ§ A: ã“ã“ã§ ã—ã‚ƒã—ã‚“ã‚’ ã¨ã£ã¦ã‚‚ ã„ã„ã§ã™ã‹ã€‚\nB: ã™ã¿ã¾ã›ã‚“ã€ã“ã“ã§ã¯ ã¨ã£ã¦ã¯ ã„ã‘ã¾ã›ã‚“ã€‚',
                question: 'ã“ã“ã§ ã—ã‚ƒã—ã‚“ã‚’ ã¨ã£ã¦ã‚‚ ã„ã„ã§ã™ã‹ã€‚',
                answer: 'ã„ã„ãˆã€ã„ã‘ã¾ã›ã‚“',
                options: ['ã„ã„ãˆã€ã„ã‘ã¾ã›ã‚“', 'ã¯ã„ã€ã„ã„ã§ã™', 'ã©ã†ã', 'ã‚ã‹ã‚Šã¾ã›ã‚“'],
                explanation: 'B denies permission ("ã¨ã£ã¦ã¯ ã„ã‘ã¾ã›ã‚“").'
            },
            {
                context: 'ğŸ§ A: ã‚ãŸã¾ãŒ ã„ãŸã„ã§ã™ã‹ã€‚\nB: ã¯ã„ã€ã™ã“ã— ã„ãŸã„ã§ã™ã€‚ã­ã¤ã‚‚ ã‚ã‚Šã¾ã™ã€‚',
                question: 'Bã•ã‚“ã¯ ã©ã†ã—ã¾ã—ãŸã‹ã€‚',
                answer: 'ã‚ãŸã¾ãŒ ã„ãŸãã¦ ã­ã¤ãŒ ã‚ã‚Šã¾ã™',
                options: ['ã‚ãŸã¾ãŒ ã„ãŸãã¦ ã­ã¤ãŒ ã‚ã‚Šã¾ã™', 'ãŠãªã‹ãŒ ã„ãŸã„ã§ã™', 'ã‘ãŒã‚’ ã—ã¾ã—ãŸ', 'ã’ã‚“ãã§ã™'],
                explanation: 'B has a headache and a fever.'
            }
        ];
        
        // Reading Comprehension Questions L9-17
        const readingQuestions = [
            {
                passage: 'ã‚ãŸã—ã¯ ãŠã‚“ãŒããŒ ã™ãã§ã™ã€‚ã¨ãã« ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãŒ ã™ãã§ã™ã€‚ã¾ã„ã—ã‚…ã† ã‚³ãƒ³ã‚µãƒ¼ãƒˆã« ã„ãã¾ã™ã€‚ãƒ”ã‚¢ãƒã‚‚ ã™ã“ã— ã²ã‘ã¾ã™ã€‚',
                question: 'ã“ã® ã²ã¨ã¯ ãªã«ãŒ ã™ãã§ã™ã‹ã€‚',
                answer: 'ãŠã‚“ãŒã',
                options: ['ãŠã‚“ãŒã', 'ã‚¹ãƒãƒ¼ãƒ„', 'ã‚Šã‚‡ã†ã‚Š', 'ãˆã„ãŒ'],
                explanation: 'The passage says "ãŠã‚“ãŒããŒ ã™ãã§ã™".'
            },
            {
                passage: 'ã‚ãŸã—ã® ã¸ã‚„ã¯ ã›ã¾ã„ã§ã™ã€‚ã§ã‚‚ã€ã¾ã©ãŒ ãŠãŠãã„ã®ã§ã€ã‚ã‹ã‚‹ã„ã§ã™ã€‚ã¸ã‚„ã« ãƒ™ãƒƒãƒ‰ã¨ ã¤ããˆã¨ ã»ã‚“ã ãªãŒ ã‚ã‚Šã¾ã™ã€‚',
                question: 'ã¸ã‚„ã¯ ã©ã‚“ãª ã¸ã‚„ã§ã™ã‹ã€‚',
                answer: 'ã›ã¾ã„ã§ã™ãŒã€ã‚ã‹ã‚‹ã„ã§ã™',
                options: ['ã›ã¾ã„ã§ã™ãŒã€ã‚ã‹ã‚‹ã„ã§ã™', 'ã²ã‚ãã¦ã€ãã‚‰ã„ã§ã™', 'ã›ã¾ãã¦ã€ãã‚‰ã„ã§ã™', 'ã²ã‚ãã¦ã€ã‚ã‹ã‚‹ã„ã§ã™'],
                explanation: 'Passage says "ã›ã¾ã„ã§ã™ã€‚ã§ã‚‚...ã‚ã‹ã‚‹ã„ã§ã™".'
            },
            {
                passage: 'ã‚ãŸã—ã® ã‹ããã¯ ã”ã«ã‚“ã§ã™ã€‚ã¡ã¡ã¨ ã¯ã¯ã¨ ã‚ã­ã¨ ãŠã¨ã†ã¨ã¨ ã‚ãŸã—ã§ã™ã€‚ã‚ã­ã¯ ã‘ã£ã“ã‚“ã—ã¦ã€ã¨ã†ãã‚‡ã†ã« ã™ã‚“ã§ã„ã¾ã™ã€‚',
                question: 'ãŠã­ãˆã•ã‚“ã¯ ã©ã“ã« ã™ã‚“ã§ã„ã¾ã™ã‹ã€‚',
                answer: 'ã¨ã†ãã‚‡ã†',
                options: ['ã¨ã†ãã‚‡ã†', 'ãŠãŠã•ã‹', 'ã„ã£ã—ã‚‡ã« ã™ã‚“ã§ã„ã¾ã™', 'ã‹ã„ãŒã„'],
                explanation: 'Passage says "ã‚ã­ã¯...ã¨ã†ãã‚‡ã†ã« ã™ã‚“ã§ã„ã¾ã™".'
            },
            {
                passage: 'ã«ã»ã‚“ã§ ã„ã¡ã°ã‚“ ãŸã‹ã„ ã‚„ã¾ã¯ ãµã˜ã•ã‚“ã§ã™ã€‚ãµã˜ã•ã‚“ã¯ 3,776ãƒ¡ãƒ¼ãƒˆãƒ«ã§ã™ã€‚ã¾ã„ã¨ã— ãŸãã•ã‚“ã® ã²ã¨ãŒ ã®ã¼ã‚Šã¾ã™ã€‚',
                question: 'ãµã˜ã•ã‚“ã¯ ãªã‚“ãƒ¡ãƒ¼ãƒˆãƒ«ã§ã™ã‹ã€‚',
                answer: '3,776ãƒ¡ãƒ¼ãƒˆãƒ«',
                options: ['3,776ãƒ¡ãƒ¼ãƒˆãƒ«', '3,676ãƒ¡ãƒ¼ãƒˆãƒ«', '3,876ãƒ¡ãƒ¼ãƒˆãƒ«', '3,576ãƒ¡ãƒ¼ãƒˆãƒ«'],
                explanation: 'Passage states "3,776ãƒ¡ãƒ¼ãƒˆãƒ«ã§ã™".'
            },
            {
                passage: 'ã‚ãŸã—ã¯ ã„ã¤ã‹ ã«ã»ã‚“ã¸ ã„ããŸã„ã§ã™ã€‚ã«ã»ã‚“ã§ ãŠã„ã—ã„ ã™ã—ã‚’ ãŸã¹ãŸã„ã§ã™ã€‚ãã—ã¦ã€ãã‚‡ã†ã¨ã® ãŠã¦ã‚‰ã‚’ ã¿ãŸã„ã§ã™ã€‚',
                question: 'ã“ã® ã²ã¨ã¯ ã«ã»ã‚“ã§ ãªã«ã‚’ ã—ãŸã„ã§ã™ã‹ã€‚',
                answer: 'ã™ã—ã‚’ ãŸã¹ã¦ã€ãŠã¦ã‚‰ã‚’ ã¿ãŸã„',
                options: ['ã™ã—ã‚’ ãŸã¹ã¦ã€ãŠã¦ã‚‰ã‚’ ã¿ãŸã„', 'ã‚„ã¾ã« ã®ã¼ã‚ŠãŸã„', 'ã‹ã„ã‚‚ã®ã‚’ ã—ãŸã„', 'ã«ã»ã‚“ã”ã‚’ ãªã‚‰ã„ãŸã„'],
                explanation: 'Passage lists eating sushi and seeing temples.'
            },
            {
                passage: 'ã“ã® ã³ã˜ã‚…ã¤ã‹ã‚“ã§ã¯ ã—ã‚ƒã—ã‚“ã‚’ ã¨ã£ã¦ã‚‚ ã„ã„ã§ã™ã€‚ã§ã‚‚ã€ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚’ ã¤ã‹ã£ã¦ã¯ ã„ã‘ã¾ã›ã‚“ã€‚ã—ãšã‹ã« ã¿ã¦ãã ã•ã„ã€‚',
                question: 'ã“ã® ã³ã˜ã‚…ã¤ã‹ã‚“ã§ ã—ã¦ã¯ã„ã‘ãªã„ ã“ã¨ã¯ ãªã‚“ã§ã™ã‹ã€‚',
                answer: 'ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚’ ã¤ã‹ã†ã“ã¨',
                options: ['ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚’ ã¤ã‹ã†ã“ã¨', 'ã—ã‚ƒã—ã‚“ã‚’ ã¨ã‚‹ã“ã¨', 'ã—ãšã‹ã« ã¿ã‚‹ã“ã¨', 'ã¯ã„ã‚‹ã“ã¨'],
                explanation: 'Passage says "ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚’ ã¤ã‹ã£ã¦ã¯ ã„ã‘ã¾ã›ã‚“".'
            },
            {
                passage: 'ã¾ã„ã‚ã• 6ã˜ã« ãŠãã¾ã™ã€‚ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’ ã‚ã³ã¦ã€ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¦ã€7ã˜ã« ã„ãˆã‚’ ã§ã¾ã™ã€‚ãˆãã¾ã§ ã‚ã‚‹ã„ã¦ 10ã·ã‚“ ã‹ã‹ã‚Šã¾ã™ã€‚',
                question: 'ãˆãã¾ã§ ã©ã®ãã‚‰ã„ ã‹ã‹ã‚Šã¾ã™ã‹ã€‚',
                answer: 'ã‚ã‚‹ã„ã¦ 10ã·ã‚“',
                options: ['ã‚ã‚‹ã„ã¦ 10ã·ã‚“', 'ã‚ã‚‹ã„ã¦ 20ã·ã‚“', 'ãƒã‚¹ã§ 10ã·ã‚“', 'ã˜ã¦ã‚“ã—ã‚ƒã§ 10ã·ã‚“'],
                explanation: 'Passage says "ãˆãã¾ã§ ã‚ã‚‹ã„ã¦ 10ã·ã‚“".'
            },
            {
                passage: 'ãã®ã† ã­ã¤ãŒ ã‚ã‚Šã¾ã—ãŸã€‚ãã™ã‚Šã‚’ ã®ã‚“ã§ã€ã¯ã‚„ã ã­ã¾ã—ãŸã€‚ãã‚‡ã†ã¯ ã­ã¤ã¯ ã‚ã‚Šã¾ã›ã‚“ãŒã€ã¾ã  ã™ã“ã— ã‚ãŸã¾ãŒ ã„ãŸã„ã§ã™ã€‚',
                question: 'ãã‚‡ã†ã® ã¡ã‚‡ã†ã—ã¯ ã©ã†ã§ã™ã‹ã€‚',
                answer: 'ã­ã¤ã¯ ãªã„ãŒã€ã‚ãŸã¾ãŒ ã„ãŸã„',
                options: ['ã­ã¤ã¯ ãªã„ãŒã€ã‚ãŸã¾ãŒ ã„ãŸã„', 'ã‚‚ã† ã’ã‚“ãã§ã™', 'ã¾ã  ã­ã¤ãŒ ã‚ã‚‹', 'ã¨ã¦ã‚‚ ã‚ã‚‹ã„'],
                explanation: 'Passage: "ã­ã¤ã¯ ã‚ã‚Šã¾ã›ã‚“ãŒã€ã¾ã ...ã‚ãŸã¾ãŒ ã„ãŸã„ã§ã™".'
            },
            {
                passage: 'ã‚ãŸã—ã¯ ãˆã„ã”ãŒ ã‚ã¾ã‚Š ã˜ã‚‡ã†ãšã˜ã‚ƒ ã‚ã‚Šã¾ã›ã‚“ã€‚ã§ã‚‚ã€ã«ã»ã‚“ã”ã¯ ã™ã“ã— ã‚ã‹ã‚Šã¾ã™ã€‚ã¾ã„ã«ã¡ ã¹ã‚“ãã‚‡ã†ã—ã¦ã„ã¾ã™ã€‚',
                question: 'ã“ã® ã²ã¨ã¯ ã©ã‚“ãª ã“ã¨ã°ãŒ ã‚ã‹ã‚Šã¾ã™ã‹ã€‚',
                answer: 'ã«ã»ã‚“ã”ãŒ ã™ã“ã— ã‚ã‹ã‚Šã¾ã™',
                options: ['ã«ã»ã‚“ã”ãŒ ã™ã“ã— ã‚ã‹ã‚Šã¾ã™', 'ãˆã„ã”ãŒ ã˜ã‚‡ã†ãšã§ã™', 'ã¡ã‚…ã†ã”ãã”ãŒ ã‚ã‹ã‚Šã¾ã™', 'ãªã«ã‚‚ ã‚ã‹ã‚Šã¾ã›ã‚“'],
                explanation: 'Passage says "ã«ã»ã‚“ã”ã¯ ã™ã“ã— ã‚ã‹ã‚Šã¾ã™".'
            },
            {
                passage: 'ã“ã® ã“ã†ãˆã‚“ã¯ ã¨ã¦ã‚‚ ã²ã‚ã„ã§ã™ã€‚ãŸãã•ã‚“ã® ããŒ ã‚ã‚Šã¾ã™ã€‚ã‚„ã™ã¿ã® ã²ã« ã‹ããã§ ã‚ãã³ã« ãã¾ã™ã€‚ã“ã©ã‚‚ãŸã¡ã¯ ã’ã‚“ãã« ã‚ãã‚“ã§ã„ã¾ã™ã€‚',
                question: 'ã“ã†ãˆã‚“ã§ ã ã‚ŒãŒ ã‚ãã‚“ã§ã„ã¾ã™ã‹ã€‚',
                answer: 'ã“ã©ã‚‚ãŸã¡',
                options: ['ã“ã©ã‚‚ãŸã¡', 'ãŠã¨ãª', 'ã„ã¬', 'ã ã‚Œã‚‚ ã„ã¾ã›ã‚“'],
                explanation: 'Passage says "ã“ã©ã‚‚ãŸã¡ã¯ ã’ã‚“ãã« ã‚ãã‚“ã§ã„ã¾ã™".'
            }
        ];
        
        // ===== GAME STATE =====
        let currentSection = 'vocab';
        let currentQuestion = 0;
        let score = 0;
        let questionsAnswered = 0;
        const totalQuestions = 40;
        const passingScore = 80;
        
        let sectionStatus = {
            vocab: { completed: false, correct: 0, total: 10 },
            grammar: { completed: false, correct: 0, total: 10 },
            listening: { completed: false, correct: 0, total: 10 },
            reading: { completed: false, correct: 0, total: 10 }
        };
        
        let vocabQuestions = [];
        let grammarQs = [];
        let listeningQs = [];
        let readingQs = [];
        
        // ===== UTILITY FUNCTIONS =====
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        
        function getWrongOptions(correctAnswer, allOptions, count = 3) {
            const filtered = allOptions.filter(opt => opt !== correctAnswer);
            return shuffleArray(filtered).slice(0, count);
        }
        
        // ===== QUESTION GENERATION =====
        function generateVocabQuestions() {
            const selected = shuffleArray(vocabularyData).slice(0, 10);
            const allEnglish = vocabularyData.map(v => v.en);
            const allJapanese = vocabularyData.map(v => v.jp);
            
            vocabQuestions = selected.map((vocab, index) => {
                const isJpToEn = index < 5; // Mix of both directions
                if (isJpToEn) {
                    const wrongOptions = getWrongOptions(vocab.en, allEnglish);
                    return {
                        prompt: vocab.jp,
                        answer: vocab.en,
                        options: shuffleArray([vocab.en, ...wrongOptions]),
                        type: 'jp-to-en',
                        lesson: vocab.lesson,
                        category: vocab.category
                    };
                } else {
                    const wrongOptions = getWrongOptions(vocab.jp, allJapanese);
                    return {
                        prompt: vocab.en,
                        answer: vocab.jp,
                        options: shuffleArray([vocab.jp, ...wrongOptions]),
                        type: 'en-to-jp',
                        lesson: vocab.lesson,
                        category: vocab.category
                    };
                }
            });
        }
        
        function generateGrammarQuestions() {
            grammarQs = shuffleArray([...grammarQuestions]).slice(0, 10);
        }
        
        function generateListeningQuestions() {
            listeningQs = shuffleArray([...listeningQuestions]).slice(0, 10);
        }
        
        function generateReadingQuestions() {
            readingQs = shuffleArray([...readingQuestions]).slice(0, 10);
        }
        
        // ===== UI FUNCTIONS =====
        function startQuiz() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('scoreBoard').classList.remove('hidden');
            document.getElementById('sectionTabs').classList.remove('hidden');
            document.getElementById('vocab-section').classList.add('active');
            
            generateVocabQuestions();
            generateGrammarQuestions();
            generateListeningQuestions();
            generateReadingQuestions();
            
            updateScoreBoard();
            loadVocabQuestion();
        }
        
        function switchSection(section) {
            if (document.getElementById(`tab-${section}`).classList.contains('locked')) {
                return;
            }
            
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tab-${section}`).classList.add('active');
            
            document.querySelectorAll('.practice-section').forEach(s => s.classList.remove('active'));
            document.getElementById(`${section}-section`).classList.add('active');
            
            currentSection = section;
            currentQuestion = 0;
            
            if (section === 'vocab') loadVocabQuestion();
            else if (section === 'grammar') loadGrammarQuestion();
            else if (section === 'listening') loadListeningQuestion();
            else if (section === 'reading') loadReadingQuestion();
        }
        
        function updateScoreBoard() {
            document.getElementById('score').textContent = score;
            document.getElementById('answered').textContent = questionsAnswered;
            
            const progress = (questionsAnswered / totalQuestions) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }
        
        // ===== VOCAB SECTION =====
        function loadVocabQuestion() {
            if (currentQuestion >= vocabQuestions.length) {
                completeSection('vocab');
                return;
            }
            
            const q = vocabQuestions[currentQuestion];
            const isJpToEn = q.type === 'jp-to-en';
            
            document.getElementById('vocab-question').innerHTML = `
                <div class="question-box">
                    <div class="question-number">
                        ã‚‚ã‚“ã ã„ ${currentQuestion + 1} / ${vocabQuestions.length}
                        <span class="category-indicator lesson">L${q.lesson}</span>
                    </div>
                    <div class="question-text">
                        ${isJpToEn ? 'ã“ã®ã“ã¨ã°ã® ãˆã„ã”ã¯ ãªã‚“ã§ã™ã‹ï¼Ÿ' : 'ã“ã®ã“ã¨ã°ã® ã«ã»ã‚“ã”ã¯ ãªã‚“ã§ã™ã‹ï¼Ÿ'}
                    </div>
                    <div class="${isJpToEn ? 'japanese-prompt' : 'english-prompt'}">${q.prompt}</div>
                    <div class="options-grid" id="vocab-options">
                        ${q.options.map(opt => `
                            <button class="option-btn" data-answer="${opt}">${opt}</button>
                        `).join('')}
                    </div>
                    <div class="feedback" id="vocab-feedback"></div>
                </div>
            `;
            
            document.querySelectorAll('#vocab-options .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkVocabAnswer(this, this.dataset.answer, q.answer);
                });
            });
        }
        
        function checkVocabAnswer(btn, selected, correct) {
            const buttons = document.querySelectorAll('#vocab-options .option-btn');
            buttons.forEach(b => b.disabled = true);
            
            const isCorrect = selected === correct;
            
            if (isCorrect) {
                btn.classList.add('correct');
                score += 10;
                sectionStatus.vocab.correct++;
            } else {
                btn.classList.add('incorrect');
                buttons.forEach(b => {
                    if (b.dataset.answer === correct) b.classList.add('correct');
                });
            }
            
            questionsAnswered++;
            updateScoreBoard();
            
            const feedback = document.getElementById('vocab-feedback');
            if (isCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = `âœ… ã›ã„ã‹ã„ï¼ <button class="next-btn" onclick="nextVocabQuestion()">ã¤ãã¸ â†’</button>`;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `âŒ ã–ã‚“ã­ã‚“... <div class="correct-answer">ã“ãŸãˆ: ${correct}</div><button class="next-btn" onclick="nextVocabQuestion()">ã¤ãã¸ â†’</button>`;
            }
        }
        
        function nextVocabQuestion() {
            currentQuestion++;
            loadVocabQuestion();
        }
        
        // ===== GRAMMAR SECTION =====
        function loadGrammarQuestion() {
            if (currentQuestion >= grammarQs.length) {
                completeSection('grammar');
                return;
            }
            
            const q = grammarQs[currentQuestion];
            const sentenceWithBlank = q.sentence.replace('___', '<span style="color: #e94560; font-weight: bold; border-bottom: 3px solid #e94560; padding: 0 10px;">ï¼Ÿ</span>');
            
            document.getElementById('grammar-question').innerHTML = `
                <div class="question-box">
                    <div class="question-number">
                        ã‚‚ã‚“ã ã„ ${currentQuestion + 1} / ${grammarQs.length}
                        <span class="category-indicator lesson">L${q.lesson}</span>
                    </div>
                    <div class="question-text">ãŸã ã—ã„ ã“ã¨ã°ã‚’ ãˆã‚‰ã‚“ã§ãã ã•ã„ã€‚</div>
                    <div class="japanese-prompt">${sentenceWithBlank}</div>
                    <div class="options-grid" id="grammar-options">
                        ${shuffleArray(q.options).map(opt => `
                            <button class="option-btn" data-answer="${opt}">${opt}</button>
                        `).join('')}
                    </div>
                    <div class="feedback" id="grammar-feedback"></div>
                </div>
            `;
            
            document.querySelectorAll('#grammar-options .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkGrammarAnswer(this, this.dataset.answer, q.answer, q.explanation);
                });
            });
        }
        
        function checkGrammarAnswer(btn, selected, correct, explanation) {
            const buttons = document.querySelectorAll('#grammar-options .option-btn');
            buttons.forEach(b => b.disabled = true);
            
            const isCorrect = selected === correct;
            
            if (isCorrect) {
                btn.classList.add('correct');
                score += 10;
                sectionStatus.grammar.correct++;
            } else {
                btn.classList.add('incorrect');
                buttons.forEach(b => {
                    if (b.dataset.answer === correct) b.classList.add('correct');
                });
            }
            
            questionsAnswered++;
            updateScoreBoard();
            
            const feedback = document.getElementById('grammar-feedback');
            if (isCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = `âœ… ã›ã„ã‹ã„ï¼ <div class="explanation">ğŸ’¡ ${explanation}</div><button class="next-btn" onclick="nextGrammarQuestion()">ã¤ãã¸ â†’</button>`;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `âŒ ã–ã‚“ã­ã‚“... <div class="correct-answer">ã“ãŸãˆ: ${correct}</div><div class="explanation">ğŸ’¡ ${explanation}</div><button class="next-btn" onclick="nextGrammarQuestion()">ã¤ãã¸ â†’</button>`;
            }
        }
        
        function nextGrammarQuestion() {
            currentQuestion++;
            loadGrammarQuestion();
        }
        
        // ===== LISTENING SECTION =====
        function loadListeningQuestion() {
            if (currentQuestion >= listeningQs.length) {
                completeSection('listening');
                return;
            }
            
            const q = listeningQs[currentQuestion];
            
            document.getElementById('listening-question').innerHTML = `
                <div class="question-box">
                    <div class="question-number">ã‚‚ã‚“ã ã„ ${currentQuestion + 1} / ${listeningQs.length}</div>
                    <div class="question-text">ã‹ã„ã‚ã‚’ ã‚ˆã‚“ã§ã€ã—ã¤ã‚‚ã‚“ã« ã“ãŸãˆã¦ãã ã•ã„ã€‚</div>
                    
                    <div class="audio-context">
                        <div class="audio-icon">ğŸ§</div>
                        <div class="dialogue">${q.context.replace(/\n/g, '<br>')}</div>
                    </div>
                    
                    <div class="question-text" style="font-weight: 700; font-size: clamp(16px, 2.5vw, 20px); margin-top: 20px;">
                        â“ ${q.question}
                    </div>
                    
                    <div class="options-grid" id="listening-options">
                        ${shuffleArray(q.options).map(opt => `
                            <button class="option-btn" data-answer="${opt}">${opt}</button>
                        `).join('')}
                    </div>
                    <div class="feedback" id="listening-feedback"></div>
                </div>
            `;
            
            document.querySelectorAll('#listening-options .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkListeningAnswer(this, this.dataset.answer, q.answer, q.explanation);
                });
            });
        }
        
        function checkListeningAnswer(btn, selected, correct, explanation) {
            const buttons = document.querySelectorAll('#listening-options .option-btn');
            buttons.forEach(b => b.disabled = true);
            
            const isCorrect = selected === correct;
            
            if (isCorrect) {
                btn.classList.add('correct');
                score += 10;
                sectionStatus.listening.correct++;
            } else {
                btn.classList.add('incorrect');
                buttons.forEach(b => {
                    if (b.dataset.answer === correct) b.classList.add('correct');
                });
            }
            
            questionsAnswered++;
            updateScoreBoard();
            
            const feedback = document.getElementById('listening-feedback');
            if (isCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = `âœ… ã›ã„ã‹ã„ï¼ <div class="explanation">ğŸ’¡ ${explanation}</div><button class="next-btn" onclick="nextListeningQuestion()">ã¤ãã¸ â†’</button>`;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `âŒ ã–ã‚“ã­ã‚“... <div class="correct-answer">ã“ãŸãˆ: ${correct}</div><div class="explanation">ğŸ’¡ ${explanation}</div><button class="next-btn" onclick="nextListeningQuestion()">ã¤ãã¸ â†’</button>`;
            }
        }
        
        function nextListeningQuestion() {
            currentQuestion++;
            loadListeningQuestion();
        }
        
        // ===== READING SECTION =====
        function loadReadingQuestion() {
            if (currentQuestion >= readingQs.length) {
                completeSection('reading');
                return;
            }
            
            const q = readingQs[currentQuestion];
            
            document.getElementById('reading-question').innerHTML = `
                <div class="question-box">
                    <div class="question-number">ã‚‚ã‚“ã ã„ ${currentQuestion + 1} / ${readingQs.length}</div>
                    <div class="question-text">ã¤ãã® ã¶ã‚“ã—ã‚‡ã†ã‚’ ã‚ˆã‚“ã§ã€ã—ã¤ã‚‚ã‚“ã« ã“ãŸãˆã¦ãã ã•ã„ã€‚</div>
                    
                    <div class="reading-passage">
                        <div class="passage-title">ğŸ“– ã¶ã‚“ã—ã‚‡ã†</div>
                        ${q.passage}
                    </div>
                    
                    <div class="question-text" style="font-weight: 700; font-size: clamp(16px, 2.5vw, 20px); margin-top: 20px;">
                        â“ ${q.question}
                    </div>
                    
                    <div class="options-grid" id="reading-options">
                        ${shuffleArray(q.options).map(opt => `
                            <button class="option-btn" data-answer="${opt}">${opt}</button>
                        `).join('')}
                    </div>
                    <div class="feedback" id="reading-feedback"></div>
                </div>
            `;
            
            document.querySelectorAll('#reading-options .option-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkReadingAnswer(this, this.dataset.answer, q.answer, q.explanation);
                });
            });
        }
        
        function checkReadingAnswer(btn, selected, correct, explanation) {
            const buttons = document.querySelectorAll('#reading-options .option-btn');
            buttons.forEach(b => b.disabled = true);
            
            const isCorrect = selected === correct;
            
            if (isCorrect) {
                btn.classList.add('correct');
                score += 10;
                sectionStatus.reading.correct++;
            } else {
                btn.classList.add('incorrect');
                buttons.forEach(b => {
                    if (b.dataset.answer === correct) b.classList.add('correct');
                });
            }
            
            questionsAnswered++;
            updateScoreBoard();
            
            const feedback = document.getElementById('reading-feedback');
            if (isCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = `âœ… ã›ã„ã‹ã„ï¼ <div class="explanation">ğŸ’¡ ${explanation}</div><button class="next-btn" onclick="nextReadingQuestion()">ã¤ãã¸ â†’</button>`;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `âŒ ã–ã‚“ã­ã‚“... <div class="correct-answer">ã“ãŸãˆ: ${correct}</div><div class="explanation">ğŸ’¡ ${explanation}</div><button class="next-btn" onclick="nextReadingQuestion()">ã¤ãã¸ â†’</button>`;
            }
        }
        
        function nextReadingQuestion() {
            currentQuestion++;
            loadReadingQuestion();
        }
        
        // ===== SECTION COMPLETION =====
        function completeSection(section) {
            sectionStatus[section].completed = true;
            document.getElementById(`tab-${section}`).classList.remove('active');
            document.getElementById(`tab-${section}`).classList.add('completed');
            
            // Determine next section
            const sections = ['vocab', 'grammar', 'listening', 'reading'];
            const currentIndex = sections.indexOf(section);
            
            if (currentIndex < sections.length - 1) {
                const nextSection = sections[currentIndex + 1];
                document.getElementById(`tab-${nextSection}`).classList.remove('locked');
                
                // Auto-switch to next section
                currentQuestion = 0;
                switchSection(nextSection);
            } else {
                // All sections complete - show results
                showResults();
            }
        }
        
        // ===== RESULTS =====
        function showResults() {
            document.querySelectorAll('.practice-section').forEach(s => s.classList.remove('active'));
            document.getElementById('results-section').classList.add('active');
            document.getElementById('sectionTabs').classList.add('hidden');
            
            const totalCorrect = sectionStatus.vocab.correct + sectionStatus.grammar.correct + 
                                sectionStatus.listening.correct + sectionStatus.reading.correct;
            const percentage = Math.round((totalCorrect / totalQuestions) * 100);
            const passed = percentage >= passingScore;
            
            document.getElementById('final-score').textContent = percentage + '%';
            document.getElementById('final-score').className = 'results-score ' + (passed ? 'pass' : 'fail');
            
            document.getElementById('results-title').textContent = passed ? 'ã”ã†ã‹ãï¼ğŸ‰' : 'ã‚‚ã†ã™ã“ã— ãŒã‚“ã°ã‚ã†ï¼';
            document.getElementById('results-title').className = 'results-title ' + (passed ? 'pass' : 'fail');
            
            document.getElementById('results-icon').textContent = passed ? 'ğŸ‰' : 'ğŸ“š';
            
            document.getElementById('results-message').innerHTML = passed 
                ? 'ã™ã°ã‚‰ã—ã„ï¼ N5ãƒ¬ãƒ™ãƒ«ã® ã«ã»ã‚“ã”ã‚’ ã‚ˆã ã‚Šã‹ã„ã—ã¦ã„ã¾ã™ï¼<br>Excellent! You understand N5 level Japanese well!'
                : 'ã¤ãã¯ ã‚‚ã£ã¨ ãŒã‚“ã°ã‚Šã¾ã—ã‚‡ã†ï¼ 80%ã„ã˜ã‚‡ã†ã§ ã”ã†ã‹ãã§ã™ã€‚<br>Try again! You need 80% or more to pass.';
            
            // Section scores
            document.getElementById('vocab-score').textContent = `${sectionStatus.vocab.correct}/${sectionStatus.vocab.total}`;
            document.getElementById('vocab-score').className = 'breakdown-value ' + 
                (sectionStatus.vocab.correct >= sectionStatus.vocab.total * 0.8 ? 'pass' : 'fail');
            
            document.getElementById('grammar-score').textContent = `${sectionStatus.grammar.correct}/${sectionStatus.grammar.total}`;
            document.getElementById('grammar-score').className = 'breakdown-value ' + 
                (sectionStatus.grammar.correct >= sectionStatus.grammar.total * 0.8 ? 'pass' : 'fail');
            
            document.getElementById('listening-score').textContent = `${sectionStatus.listening.correct}/${sectionStatus.listening.total}`;
            document.getElementById('listening-score').className = 'breakdown-value ' + 
                (sectionStatus.listening.correct >= sectionStatus.listening.total * 0.8 ? 'pass' : 'fail');
            
            document.getElementById('reading-score').textContent = `${sectionStatus.reading.correct}/${sectionStatus.reading.total}`;
            document.getElementById('reading-score').className = 'breakdown-value ' + 
                (sectionStatus.reading.correct >= sectionStatus.reading.total * 0.8 ? 'pass' : 'fail');
        }
        
        // ===== RESTART =====
        function restartQuiz() {
            currentSection = 'vocab';
            currentQuestion = 0;
            score = 0;
            questionsAnswered = 0;
            
            sectionStatus = {
                vocab: { completed: false, correct: 0, total: 10 },
                grammar: { completed: false, correct: 0, total: 10 },
                listening: { completed: false, correct: 0, total: 10 },
                reading: { completed: false, correct: 0, total: 10 }
            };
            
            // Regenerate all questions (randomized)
            generateVocabQuestions();
            generateGrammarQuestions();
            generateListeningQuestions();
            generateReadingQuestions();
            
            // Reset tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active', 'completed', 'locked');
            });
            document.getElementById('tab-vocab').classList.add('active');
            document.getElementById('tab-grammar').classList.add('locked');
            document.getElementById('tab-listening').classList.add('locked');
            document.getElementById('tab-reading').classList.add('locked');
            
            // Show tabs again
            document.getElementById('sectionTabs').classList.remove('hidden');
            
            // Reset sections
            document.querySelectorAll('.practice-section').forEach(s => s.classList.remove('active'));
            document.getElementById('vocab-section').classList.add('active');
            
            updateScoreBoard();
            loadVocabQuestion();
        }
        
        // ===== REFERENCE TOGGLE =====
        function toggleReference() {
            const card = document.getElementById('referenceCard');
            card.classList.toggle('show');
            const btn = document.querySelector('.reference-btn');
            btn.textContent = card.classList.contains('show') ? 'ğŸ“– ã•ã‚“ã“ã†ãƒªã‚¹ãƒˆã‚’ ã‹ãã™' : 'ğŸ“– ã•ã‚“ã“ã†ãƒªã‚¹ãƒˆã‚’ ã¿ã‚‹';
        }
    </script>
</body>
</html>